(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){module.exports={default:require("core-js/library/fn/array/from"),__esModule:true}},{"core-js/library/fn/array/from":17}],2:[function(require,module,exports){module.exports={default:require("core-js/library/fn/get-iterator"),__esModule:true}},{"core-js/library/fn/get-iterator":18}],3:[function(require,module,exports){module.exports={default:require("core-js/library/fn/object/create"),__esModule:true}},{"core-js/library/fn/object/create":19}],4:[function(require,module,exports){module.exports={default:require("core-js/library/fn/object/define-property"),__esModule:true}},{"core-js/library/fn/object/define-property":20}],5:[function(require,module,exports){module.exports={default:require("core-js/library/fn/object/get-own-property-descriptor"),__esModule:true}},{"core-js/library/fn/object/get-own-property-descriptor":21}],6:[function(require,module,exports){module.exports={default:require("core-js/library/fn/object/get-prototype-of"),__esModule:true}},{"core-js/library/fn/object/get-prototype-of":22}],7:[function(require,module,exports){module.exports={default:require("core-js/library/fn/object/set-prototype-of"),__esModule:true}},{"core-js/library/fn/object/set-prototype-of":23}],8:[function(require,module,exports){module.exports={default:require("core-js/library/fn/symbol"),__esModule:true}},{"core-js/library/fn/symbol":24}],9:[function(require,module,exports){module.exports={default:require("core-js/library/fn/symbol/iterator"),__esModule:true}},{"core-js/library/fn/symbol/iterator":25}],10:[function(require,module,exports){"use strict";exports.__esModule=true;exports.default=function(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}},{}],11:[function(require,module,exports){"use strict";exports.__esModule=true;var _defineProperty=require("../core-js/object/define-property");var _defineProperty2=_interopRequireDefault(_defineProperty);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;(0,_defineProperty2.default)(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}()},{"../core-js/object/define-property":4}],12:[function(require,module,exports){"use strict";exports.__esModule=true;var _getPrototypeOf=require("../core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _getOwnPropertyDescriptor=require("../core-js/object/get-own-property-descriptor");var _getOwnPropertyDescriptor2=_interopRequireDefault(_getOwnPropertyDescriptor);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=(0,_getOwnPropertyDescriptor2.default)(object,property);if(desc===undefined){var parent=(0,_getPrototypeOf2.default)(object);if(parent===null){return undefined}else{return get(parent,property,receiver)}}else if("value"in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}}},{"../core-js/object/get-own-property-descriptor":5,"../core-js/object/get-prototype-of":6}],13:[function(require,module,exports){"use strict";exports.__esModule=true;var _setPrototypeOf=require("../core-js/object/set-prototype-of");var _setPrototypeOf2=_interopRequireDefault(_setPrototypeOf);var _create=require("../core-js/object/create");var _create2=_interopRequireDefault(_create);var _typeof2=require("../helpers/typeof");var _typeof3=_interopRequireDefault(_typeof2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=function(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":(0,_typeof3.default)(superClass)))}subClass.prototype=(0,_create2.default)(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)_setPrototypeOf2.default?(0,_setPrototypeOf2.default)(subClass,superClass):subClass.__proto__=superClass}},{"../core-js/object/create":3,"../core-js/object/set-prototype-of":7,"../helpers/typeof":16}],14:[function(require,module,exports){"use strict";exports.__esModule=true;var _typeof2=require("../helpers/typeof");var _typeof3=_interopRequireDefault(_typeof2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=function(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&((typeof call==="undefined"?"undefined":(0,_typeof3.default)(call))==="object"||typeof call==="function")?call:self}},{"../helpers/typeof":16}],15:[function(require,module,exports){"use strict";exports.__esModule=true;var _from=require("../core-js/array/from");var _from2=_interopRequireDefault(_from);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=function(arr){return Array.isArray(arr)?arr:(0,_from2.default)(arr)}},{"../core-js/array/from":1}],16:[function(require,module,exports){"use strict";var _typeof=typeof _Symbol==="function"&&typeof _Symbol$iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof _Symbol==="function"&&obj.constructor===_Symbol?"symbol":typeof obj};exports.__esModule=true;var _iterator=require("../core-js/symbol/iterator");var _iterator2=_interopRequireDefault(_iterator);var _symbol=require("../core-js/symbol");var _symbol2=_interopRequireDefault(_symbol);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=typeof _symbol2.default==="function"&&_typeof(_iterator2.default)==="symbol"?function(obj){return typeof obj==="undefined"?"undefined":_typeof(obj)}:function(obj){return obj&&typeof _symbol2.default==="function"&&obj.constructor===_symbol2.default?"symbol":typeof obj==="undefined"?"undefined":_typeof(obj)}},{"../core-js/symbol":8,"../core-js/symbol/iterator":9}],17:[function(require,module,exports){require("../../modules/es6.string.iterator");require("../../modules/es6.array.from");module.exports=require("../../modules/$.core").Array.from},{"../../modules/$.core":31,"../../modules/es6.array.from":70,"../../modules/es6.string.iterator":76}],18:[function(require,module,exports){require("../modules/web.dom.iterable");require("../modules/es6.string.iterator");module.exports=require("../modules/core.get-iterator")},{"../modules/core.get-iterator":69,"../modules/es6.string.iterator":76,"../modules/web.dom.iterable":78}],19:[function(require,module,exports){var $=require("../../modules/$");module.exports=function create(P,D){return $.create(P,D)}},{"../../modules/$":52}],20:[function(require,module,exports){var $=require("../../modules/$");module.exports=function defineProperty(it,key,desc){return $.setDesc(it,key,desc)}},{"../../modules/$":52}],21:[function(require,module,exports){var $=require("../../modules/$");require("../../modules/es6.object.get-own-property-descriptor");module.exports=function getOwnPropertyDescriptor(it,key){return $.getDesc(it,key)}},{"../../modules/$":52,"../../modules/es6.object.get-own-property-descriptor":72}],22:[function(require,module,exports){require("../../modules/es6.object.get-prototype-of");module.exports=require("../../modules/$.core").Object.getPrototypeOf},{"../../modules/$.core":31,"../../modules/es6.object.get-prototype-of":73}],23:[function(require,module,exports){require("../../modules/es6.object.set-prototype-of");module.exports=require("../../modules/$.core").Object.setPrototypeOf},{"../../modules/$.core":31,"../../modules/es6.object.set-prototype-of":74}],24:[function(require,module,exports){require("../../modules/es6.symbol");require("../../modules/es6.object.to-string");module.exports=require("../../modules/$.core").Symbol},{"../../modules/$.core":31,"../../modules/es6.object.to-string":75,"../../modules/es6.symbol":77}],25:[function(require,module,exports){require("../../modules/es6.string.iterator");require("../../modules/web.dom.iterable");module.exports=require("../../modules/$.wks")("iterator")},{"../../modules/$.wks":67,"../../modules/es6.string.iterator":76,"../../modules/web.dom.iterable":78}],26:[function(require,module,exports){module.exports=function(it){if(typeof it!="function")throw TypeError(it+" is not a function!");return it}},{}],27:[function(require,module,exports){module.exports=function(){}},{}],28:[function(require,module,exports){var isObject=require("./$.is-object");module.exports=function(it){if(!isObject(it))throw TypeError(it+" is not an object!");return it}},{"./$.is-object":45}],29:[function(require,module,exports){var cof=require("./$.cof"),TAG=require("./$.wks")("toStringTag"),ARG=cof(function(){return arguments}())=="Arguments";module.exports=function(it){var O,T,B;return it===undefined?"Undefined":it===null?"Null":typeof(T=(O=Object(it))[TAG])=="string"?T:ARG?cof(O):(B=cof(O))=="Object"&&typeof O.callee=="function"?"Arguments":B}},{"./$.cof":30,"./$.wks":67}],30:[function(require,module,exports){var toString={}.toString;module.exports=function(it){return toString.call(it).slice(8,-1)}},{}],31:[function(require,module,exports){var core=module.exports={version:"1.2.6"};if(typeof __e=="number")__e=core},{}],32:[function(require,module,exports){var aFunction=require("./$.a-function");module.exports=function(fn,that,length){aFunction(fn);if(that===undefined)return fn;switch(length){case 1:return function(a){return fn.call(that,a)};case 2:return function(a,b){return fn.call(that,a,b)};case 3:return function(a,b,c){return fn.call(that,a,b,c)}}return function(){return fn.apply(that,arguments)}}},{"./$.a-function":26}],33:[function(require,module,exports){module.exports=function(it){if(it==undefined)throw TypeError("Can't call method on  "+it);return it}},{}],34:[function(require,module,exports){module.exports=!require("./$.fails")(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},{"./$.fails":37}],35:[function(require,module,exports){var $=require("./$");module.exports=function(it){var keys=$.getKeys(it),getSymbols=$.getSymbols;if(getSymbols){var symbols=getSymbols(it),isEnum=$.isEnum,i=0,key;while(symbols.length>i)if(isEnum.call(it,key=symbols[i++]))keys.push(key)}return keys}},{"./$":52}],36:[function(require,module,exports){var global=require("./$.global"),core=require("./$.core"),ctx=require("./$.ctx"),PROTOTYPE="prototype";var $export=function(type,name,source){var IS_FORCED=type&$export.F,IS_GLOBAL=type&$export.G,IS_STATIC=type&$export.S,IS_PROTO=type&$export.P,IS_BIND=type&$export.B,IS_WRAP=type&$export.W,exports=IS_GLOBAL?core:core[name]||(core[name]={}),target=IS_GLOBAL?global:IS_STATIC?global[name]:(global[name]||{})[PROTOTYPE],key,own,out;if(IS_GLOBAL)source=name;for(key in source){own=!IS_FORCED&&target&&key in target;if(own&&key in exports)continue;out=own?target[key]:source[key];exports[key]=IS_GLOBAL&&typeof target[key]!="function"?source[key]:IS_BIND&&own?ctx(out,global):IS_WRAP&&target[key]==out?function(C){var F=function(param){return this instanceof C?new C(param):C(param)};F[PROTOTYPE]=C[PROTOTYPE];return F}(out):IS_PROTO&&typeof out=="function"?ctx(Function.call,out):out;if(IS_PROTO)(exports[PROTOTYPE]||(exports[PROTOTYPE]={}))[key]=out}};$export.F=1;$export.G=2;$export.S=4;$export.P=8;$export.B=16;$export.W=32;module.exports=$export},{"./$.core":31,"./$.ctx":32,"./$.global":39}],37:[function(require,module,exports){module.exports=function(exec){try{return!!exec()}catch(e){return true}}},{}],38:[function(require,module,exports){var toIObject=require("./$.to-iobject"),getNames=require("./$").getNames,toString={}.toString;var windowNames=typeof window=="object"&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];var getWindowNames=function(it){try{return getNames(it)}catch(e){return windowNames.slice()}};module.exports.get=function getOwnPropertyNames(it){if(windowNames&&toString.call(it)=="[object Window]")return getWindowNames(it);return getNames(toIObject(it))}},{"./$":52,"./$.to-iobject":63}],39:[function(require,module,exports){var global=module.exports=typeof window!="undefined"&&window.Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")();if(typeof __g=="number")__g=global},{}],40:[function(require,module,exports){var hasOwnProperty={}.hasOwnProperty;module.exports=function(it,key){return hasOwnProperty.call(it,key)}},{}],41:[function(require,module,exports){var $=require("./$"),createDesc=require("./$.property-desc");module.exports=require("./$.descriptors")?function(object,key,value){return $.setDesc(object,key,createDesc(1,value))}:function(object,key,value){object[key]=value;return object}},{"./$":52,"./$.descriptors":34,"./$.property-desc":56}],42:[function(require,module,exports){var cof=require("./$.cof");module.exports=Object("z").propertyIsEnumerable(0)?Object:function(it){return cof(it)=="String"?it.split(""):Object(it)}},{"./$.cof":30}],43:[function(require,module,exports){var Iterators=require("./$.iterators"),ITERATOR=require("./$.wks")("iterator"),ArrayProto=Array.prototype;module.exports=function(it){return it!==undefined&&(Iterators.Array===it||ArrayProto[ITERATOR]===it)}},{"./$.iterators":51,"./$.wks":67}],44:[function(require,module,exports){var cof=require("./$.cof");module.exports=Array.isArray||function(arg){return cof(arg)=="Array"}},{"./$.cof":30}],45:[function(require,module,exports){module.exports=function(it){return typeof it==="object"?it!==null:typeof it==="function"}},{}],46:[function(require,module,exports){var anObject=require("./$.an-object");module.exports=function(iterator,fn,value,entries){try{return entries?fn(anObject(value)[0],value[1]):fn(value)}catch(e){var ret=iterator["return"];if(ret!==undefined)anObject(ret.call(iterator));throw e}}},{"./$.an-object":28}],47:[function(require,module,exports){"use strict";var $=require("./$"),descriptor=require("./$.property-desc"),setToStringTag=require("./$.set-to-string-tag"),IteratorPrototype={};require("./$.hide")(IteratorPrototype,require("./$.wks")("iterator"),function(){return this});module.exports=function(Constructor,NAME,next){Constructor.prototype=$.create(IteratorPrototype,{next:descriptor(1,next)});setToStringTag(Constructor,NAME+" Iterator")}},{"./$":52,"./$.hide":41,"./$.property-desc":56,"./$.set-to-string-tag":59,"./$.wks":67}],48:[function(require,module,exports){"use strict";var LIBRARY=require("./$.library"),$export=require("./$.export"),redefine=require("./$.redefine"),hide=require("./$.hide"),has=require("./$.has"),Iterators=require("./$.iterators"),$iterCreate=require("./$.iter-create"),setToStringTag=require("./$.set-to-string-tag"),getProto=require("./$").getProto,ITERATOR=require("./$.wks")("iterator"),BUGGY=!([].keys&&"next"in[].keys()),FF_ITERATOR="@@iterator",KEYS="keys",VALUES="values";var returnThis=function(){return this};module.exports=function(Base,NAME,Constructor,next,DEFAULT,IS_SET,FORCED){$iterCreate(Constructor,NAME,next);var getMethod=function(kind){if(!BUGGY&&kind in proto)return proto[kind];switch(kind){case KEYS:return function keys(){return new Constructor(this,kind)};case VALUES:return function values(){return new Constructor(this,kind)}}return function entries(){return new Constructor(this,kind)}};var TAG=NAME+" Iterator",DEF_VALUES=DEFAULT==VALUES,VALUES_BUG=false,proto=Base.prototype,$native=proto[ITERATOR]||proto[FF_ITERATOR]||DEFAULT&&proto[DEFAULT],$default=$native||getMethod(DEFAULT),methods,key;if($native){var IteratorPrototype=getProto($default.call(new Base));setToStringTag(IteratorPrototype,TAG,true);if(!LIBRARY&&has(proto,FF_ITERATOR))hide(IteratorPrototype,ITERATOR,returnThis);if(DEF_VALUES&&$native.name!==VALUES){VALUES_BUG=true;$default=function values(){return $native.call(this)}}}if((!LIBRARY||FORCED)&&(BUGGY||VALUES_BUG||!proto[ITERATOR])){hide(proto,ITERATOR,$default)}Iterators[NAME]=$default;Iterators[TAG]=returnThis;if(DEFAULT){methods={values:DEF_VALUES?$default:getMethod(VALUES),keys:IS_SET?$default:getMethod(KEYS),entries:!DEF_VALUES?$default:getMethod("entries")};if(FORCED)for(key in methods){if(!(key in proto))redefine(proto,key,methods[key])}else $export($export.P+$export.F*(BUGGY||VALUES_BUG),NAME,methods)}return methods}},{"./$":52,"./$.export":36,"./$.has":40,"./$.hide":41,"./$.iter-create":47,"./$.iterators":51,"./$.library":54,"./$.redefine":57,"./$.set-to-string-tag":59,"./$.wks":67}],49:[function(require,module,exports){var ITERATOR=require("./$.wks")("iterator"),SAFE_CLOSING=false;try{var riter=[7][ITERATOR]();riter["return"]=function(){SAFE_CLOSING=true};Array.from(riter,function(){throw 2})}catch(e){}module.exports=function(exec,skipClosing){if(!skipClosing&&!SAFE_CLOSING)return false;var safe=false;try{var arr=[7],iter=arr[ITERATOR]();iter.next=function(){safe=true};arr[ITERATOR]=function(){return iter};exec(arr)}catch(e){}return safe}},{"./$.wks":67}],50:[function(require,module,exports){module.exports=function(done,value){return{value:value,done:!!done}}},{}],51:[function(require,module,exports){module.exports={}},{}],52:[function(require,module,exports){var $Object=Object;module.exports={create:$Object.create,getProto:$Object.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:$Object.getOwnPropertyDescriptor,setDesc:$Object.defineProperty,setDescs:$Object.defineProperties,getKeys:$Object.keys,getNames:$Object.getOwnPropertyNames,getSymbols:$Object.getOwnPropertySymbols,each:[].forEach}},{}],53:[function(require,module,exports){var $=require("./$"),toIObject=require("./$.to-iobject");module.exports=function(object,el){var O=toIObject(object),keys=$.getKeys(O),length=keys.length,index=0,key;while(length>index)if(O[key=keys[index++]]===el)return key}},{"./$":52,"./$.to-iobject":63}],54:[function(require,module,exports){module.exports=true},{}],55:[function(require,module,exports){var $export=require("./$.export"),core=require("./$.core"),fails=require("./$.fails");module.exports=function(KEY,exec){var fn=(core.Object||{})[KEY]||Object[KEY],exp={};exp[KEY]=exec(fn);$export($export.S+$export.F*fails(function(){fn(1)}),"Object",exp)}},{"./$.core":31,"./$.export":36,"./$.fails":37}],56:[function(require,module,exports){module.exports=function(bitmap,value){return{enumerable:!(bitmap&1),configurable:!(bitmap&2),writable:!(bitmap&4),value:value}}},{}],57:[function(require,module,exports){module.exports=require("./$.hide")},{"./$.hide":41}],58:[function(require,module,exports){var getDesc=require("./$").getDesc,isObject=require("./$.is-object"),anObject=require("./$.an-object");var check=function(O,proto){anObject(O);if(!isObject(proto)&&proto!==null)throw TypeError(proto+": can't set as prototype!")};module.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(test,buggy,set){try{set=require("./$.ctx")(Function.call,getDesc(Object.prototype,"__proto__").set,2);set(test,[]);buggy=!(test instanceof Array)}catch(e){buggy=true}return function setPrototypeOf(O,proto){check(O,proto);if(buggy)O.__proto__=proto;else set(O,proto);return O}}({},false):undefined),check:check}},{"./$":52,"./$.an-object":28,"./$.ctx":32,"./$.is-object":45}],59:[function(require,module,exports){var def=require("./$").setDesc,has=require("./$.has"),TAG=require("./$.wks")("toStringTag");module.exports=function(it,tag,stat){if(it&&!has(it=stat?it:it.prototype,TAG))def(it,TAG,{configurable:true,value:tag})}},{"./$":52,"./$.has":40,"./$.wks":67}],60:[function(require,module,exports){var global=require("./$.global"),SHARED="__core-js_shared__",store=global[SHARED]||(global[SHARED]={});module.exports=function(key){return store[key]||(store[key]={})}},{"./$.global":39}],61:[function(require,module,exports){var toInteger=require("./$.to-integer"),defined=require("./$.defined");module.exports=function(TO_STRING){return function(that,pos){var s=String(defined(that)),i=toInteger(pos),l=s.length,a,b;if(i<0||i>=l)return TO_STRING?"":undefined;a=s.charCodeAt(i);return a<55296||a>56319||i+1===l||(b=s.charCodeAt(i+1))<56320||b>57343?TO_STRING?s.charAt(i):a:TO_STRING?s.slice(i,i+2):(a-55296<<10)+(b-56320)+65536}}},{"./$.defined":33,"./$.to-integer":62}],62:[function(require,module,exports){var ceil=Math.ceil,floor=Math.floor;module.exports=function(it){return isNaN(it=+it)?0:(it>0?floor:ceil)(it)}},{}],63:[function(require,module,exports){var IObject=require("./$.iobject"),defined=require("./$.defined");module.exports=function(it){return IObject(defined(it))}},{"./$.defined":33,"./$.iobject":42}],64:[function(require,module,exports){var toInteger=require("./$.to-integer"),min=Math.min;module.exports=function(it){return it>0?min(toInteger(it),9007199254740991):0}},{"./$.to-integer":62}],65:[function(require,module,exports){var defined=require("./$.defined");module.exports=function(it){return Object(defined(it))}},{"./$.defined":33}],66:[function(require,module,exports){var id=0,px=Math.random();module.exports=function(key){return"Symbol(".concat(key===undefined?"":key,")_",(++id+px).toString(36))}},{}],67:[function(require,module,exports){var store=require("./$.shared")("wks"),uid=require("./$.uid"),Symbol=require("./$.global").Symbol;module.exports=function(name){return store[name]||(store[name]=Symbol&&Symbol[name]||(Symbol||uid)("Symbol."+name))}},{"./$.global":39,"./$.shared":60,"./$.uid":66}],68:[function(require,module,exports){var classof=require("./$.classof"),ITERATOR=require("./$.wks")("iterator"),Iterators=require("./$.iterators");module.exports=require("./$.core").getIteratorMethod=function(it){if(it!=undefined)return it[ITERATOR]||it["@@iterator"]||Iterators[classof(it)]}},{"./$.classof":29,"./$.core":31,"./$.iterators":51,"./$.wks":67}],69:[function(require,module,exports){var anObject=require("./$.an-object"),get=require("./core.get-iterator-method");module.exports=require("./$.core").getIterator=function(it){var iterFn=get(it);if(typeof iterFn!="function")throw TypeError(it+" is not iterable!");return anObject(iterFn.call(it))}},{"./$.an-object":28,"./$.core":31,"./core.get-iterator-method":68}],70:[function(require,module,exports){"use strict";var ctx=require("./$.ctx"),$export=require("./$.export"),toObject=require("./$.to-object"),call=require("./$.iter-call"),isArrayIter=require("./$.is-array-iter"),toLength=require("./$.to-length"),getIterFn=require("./core.get-iterator-method");$export($export.S+$export.F*!require("./$.iter-detect")(function(iter){Array.from(iter)}),"Array",{from:function from(arrayLike){var O=toObject(arrayLike),C=typeof this=="function"?this:Array,$$=arguments,$$len=$$.length,mapfn=$$len>1?$$[1]:undefined,mapping=mapfn!==undefined,index=0,iterFn=getIterFn(O),length,result,step,iterator;if(mapping)mapfn=ctx(mapfn,$$len>2?$$[2]:undefined,2);if(iterFn!=undefined&&!(C==Array&&isArrayIter(iterFn))){for(iterator=iterFn.call(O),result=new C;!(step=iterator.next()).done;index++){result[index]=mapping?call(iterator,mapfn,[step.value,index],true):step.value}}else{length=toLength(O.length);for(result=new C(length);length>index;index++){result[index]=mapping?mapfn(O[index],index):O[index]}}result.length=index;return result}})},{"./$.ctx":32,"./$.export":36,"./$.is-array-iter":43,"./$.iter-call":46,"./$.iter-detect":49,"./$.to-length":64,"./$.to-object":65,"./core.get-iterator-method":68}],71:[function(require,module,exports){"use strict";var addToUnscopables=require("./$.add-to-unscopables"),step=require("./$.iter-step"),Iterators=require("./$.iterators"),toIObject=require("./$.to-iobject");module.exports=require("./$.iter-define")(Array,"Array",function(iterated,kind){this._t=toIObject(iterated);this._i=0;this._k=kind},function(){var O=this._t,kind=this._k,index=this._i++;if(!O||index>=O.length){this._t=undefined;return step(1)}if(kind=="keys")return step(0,index);if(kind=="values")return step(0,O[index]);return step(0,[index,O[index]])},"values");Iterators.Arguments=Iterators.Array;addToUnscopables("keys");addToUnscopables("values");addToUnscopables("entries")},{"./$.add-to-unscopables":27,"./$.iter-define":48,"./$.iter-step":50,"./$.iterators":51,"./$.to-iobject":63}],72:[function(require,module,exports){var toIObject=require("./$.to-iobject");require("./$.object-sap")("getOwnPropertyDescriptor",function($getOwnPropertyDescriptor){return function getOwnPropertyDescriptor(it,key){return $getOwnPropertyDescriptor(toIObject(it),key)}})},{"./$.object-sap":55,"./$.to-iobject":63}],73:[function(require,module,exports){var toObject=require("./$.to-object");require("./$.object-sap")("getPrototypeOf",function($getPrototypeOf){return function getPrototypeOf(it){return $getPrototypeOf(toObject(it))}})},{"./$.object-sap":55,"./$.to-object":65}],74:[function(require,module,exports){var $export=require("./$.export");$export($export.S,"Object",{setPrototypeOf:require("./$.set-proto").set})},{"./$.export":36,"./$.set-proto":58}],75:[function(require,module,exports){},{}],76:[function(require,module,exports){"use strict";var $at=require("./$.string-at")(true);require("./$.iter-define")(String,"String",function(iterated){this._t=String(iterated);this._i=0},function(){var O=this._t,index=this._i,point;if(index>=O.length)return{value:undefined,done:true};point=$at(O,index);this._i+=point.length;return{value:point,done:false}})},{"./$.iter-define":48,"./$.string-at":61}],77:[function(require,module,exports){"use strict";var $=require("./$"),global=require("./$.global"),has=require("./$.has"),DESCRIPTORS=require("./$.descriptors"),$export=require("./$.export"),redefine=require("./$.redefine"),$fails=require("./$.fails"),shared=require("./$.shared"),setToStringTag=require("./$.set-to-string-tag"),uid=require("./$.uid"),wks=require("./$.wks"),keyOf=require("./$.keyof"),$names=require("./$.get-names"),enumKeys=require("./$.enum-keys"),isArray=require("./$.is-array"),anObject=require("./$.an-object"),toIObject=require("./$.to-iobject"),createDesc=require("./$.property-desc"),getDesc=$.getDesc,setDesc=$.setDesc,_create=$.create,getNames=$names.get,$Symbol=global.Symbol,$JSON=global.JSON,_stringify=$JSON&&$JSON.stringify,setter=false,HIDDEN=wks("_hidden"),isEnum=$.isEnum,SymbolRegistry=shared("symbol-registry"),AllSymbols=shared("symbols"),useNative=typeof $Symbol=="function",ObjectProto=Object.prototype;var setSymbolDesc=DESCRIPTORS&&$fails(function(){return _create(setDesc({},"a",{get:function(){return setDesc(this,"a",{value:7}).a}})).a!=7})?function(it,key,D){var protoDesc=getDesc(ObjectProto,key);if(protoDesc)delete ObjectProto[key];setDesc(it,key,D);if(protoDesc&&it!==ObjectProto)setDesc(ObjectProto,key,protoDesc)}:setDesc;var wrap=function(tag){var sym=AllSymbols[tag]=_create($Symbol.prototype);sym._k=tag;DESCRIPTORS&&setter&&setSymbolDesc(ObjectProto,tag,{configurable:true,set:function(value){if(has(this,HIDDEN)&&has(this[HIDDEN],tag))this[HIDDEN][tag]=false;setSymbolDesc(this,tag,createDesc(1,value))}});return sym};var isSymbol=function(it){return typeof it=="symbol"};var $defineProperty=function defineProperty(it,key,D){if(D&&has(AllSymbols,key)){if(!D.enumerable){if(!has(it,HIDDEN))setDesc(it,HIDDEN,createDesc(1,{}));it[HIDDEN][key]=true}else{if(has(it,HIDDEN)&&it[HIDDEN][key])it[HIDDEN][key]=false;D=_create(D,{enumerable:createDesc(0,false)})}return setSymbolDesc(it,key,D)}return setDesc(it,key,D)};var $defineProperties=function defineProperties(it,P){anObject(it);var keys=enumKeys(P=toIObject(P)),i=0,l=keys.length,key;while(l>i)$defineProperty(it,key=keys[i++],P[key]);return it};var $create=function create(it,P){return P===undefined?_create(it):$defineProperties(_create(it),P)};var $propertyIsEnumerable=function propertyIsEnumerable(key){var E=isEnum.call(this,key);return E||!has(this,key)||!has(AllSymbols,key)||has(this,HIDDEN)&&this[HIDDEN][key]?E:true};var $getOwnPropertyDescriptor=function getOwnPropertyDescriptor(it,key){var D=getDesc(it=toIObject(it),key);if(D&&has(AllSymbols,key)&&!(has(it,HIDDEN)&&it[HIDDEN][key]))D.enumerable=true;return D};var $getOwnPropertyNames=function getOwnPropertyNames(it){var names=getNames(toIObject(it)),result=[],i=0,key;while(names.length>i)if(!has(AllSymbols,key=names[i++])&&key!=HIDDEN)result.push(key);return result};var $getOwnPropertySymbols=function getOwnPropertySymbols(it){var names=getNames(toIObject(it)),result=[],i=0,key;while(names.length>i)if(has(AllSymbols,key=names[i++]))result.push(AllSymbols[key]);return result};var $stringify=function stringify(it){if(it===undefined||isSymbol(it))return;var args=[it],i=1,$$=arguments,replacer,$replacer;while($$.length>i)args.push($$[i++]);replacer=args[1];if(typeof replacer=="function")$replacer=replacer;if($replacer||!isArray(replacer))replacer=function(key,value){if($replacer)value=$replacer.call(this,key,value);if(!isSymbol(value))return value};args[1]=replacer;return _stringify.apply($JSON,args)};var buggyJSON=$fails(function(){var S=$Symbol();return _stringify([S])!="[null]"||_stringify({a:S})!="{}"||_stringify(Object(S))!="{}"});if(!useNative){$Symbol=function Symbol(){if(isSymbol(this))throw TypeError("Symbol is not a constructor");return wrap(uid(arguments.length>0?arguments[0]:undefined))};redefine($Symbol.prototype,"toString",function toString(){return this._k});isSymbol=function(it){return it instanceof $Symbol};$.create=$create;$.isEnum=$propertyIsEnumerable;$.getDesc=$getOwnPropertyDescriptor;$.setDesc=$defineProperty;$.setDescs=$defineProperties;$.getNames=$names.get=$getOwnPropertyNames;$.getSymbols=$getOwnPropertySymbols;if(DESCRIPTORS&&!require("./$.library")){redefine(ObjectProto,"propertyIsEnumerable",$propertyIsEnumerable,true)}}var symbolStatics={for:function(key){return has(SymbolRegistry,key+="")?SymbolRegistry[key]:SymbolRegistry[key]=$Symbol(key)},keyFor:function keyFor(key){return keyOf(SymbolRegistry,key)},useSetter:function(){setter=true},useSimple:function(){setter=false}};$.each.call(("hasInstance,isConcatSpreadable,iterator,match,replace,search,"+"species,split,toPrimitive,toStringTag,unscopables").split(","),function(it){var sym=wks(it);symbolStatics[it]=useNative?sym:wrap(sym)});setter=true;$export($export.G+$export.W,{Symbol:$Symbol});$export($export.S,"Symbol",symbolStatics);$export($export.S+$export.F*!useNative,"Object",{create:$create,defineProperty:$defineProperty,defineProperties:$defineProperties,getOwnPropertyDescriptor:$getOwnPropertyDescriptor,getOwnPropertyNames:$getOwnPropertyNames,getOwnPropertySymbols:$getOwnPropertySymbols});$JSON&&$export($export.S+$export.F*(!useNative||buggyJSON),"JSON",{stringify:$stringify});setToStringTag($Symbol,"Symbol");setToStringTag(Math,"Math",true);setToStringTag(global.JSON,"JSON",true)},{"./$":52,"./$.an-object":28,"./$.descriptors":34,"./$.enum-keys":35,"./$.export":36,"./$.fails":37,"./$.get-names":38,"./$.global":39,"./$.has":40,"./$.is-array":44,"./$.keyof":53,"./$.library":54,"./$.property-desc":56,"./$.redefine":57,"./$.set-to-string-tag":59,"./$.shared":60,"./$.to-iobject":63,"./$.uid":66,"./$.wks":67}],78:[function(require,module,exports){require("./es6.array.iterator");var Iterators=require("./$.iterators");Iterators.NodeList=Iterators.HTMLCollection=Iterators.Array;
},{"./$.iterators":51,"./es6.array.iterator":71}],79:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _get2=require("babel-runtime/helpers/get");var _get3=_interopRequireDefault(_get2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _device=require("./device");var _device2=_interopRequireDefault(_device);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var BIOS=function(_Device){(0,_inherits3.default)(BIOS,_Device);function BIOS(binaryCode){(0,_classCallCheck3.default)(this,BIOS);var _this=(0,_possibleConstructorReturn3.default)(this,(0,_getPrototypeOf2.default)(BIOS).call(this));_this._const=_this.constantList();if(!binaryCode instanceof Uint8Array){throw new Error("Uint8Array expected")}_this._code=binaryCode;return _this}(0,_createClass3.default)(BIOS,[{key:"name",value:function name(){return"TinyBIOS"}},{key:"deviceType",value:function deviceType(){return _device2.default.Type.BIOS}},{key:"version",value:function version(){return 0}},{key:"hasInterrupt",value:function hasInterrupt(){return false}},{key:"memorySize",value:function memorySize(){return 65536}},{key:"constantList",value:function constantList(){return{BIOS_TYPE:0,BIOS_VERSION:1,BIOS_INTERRUPT:2,BIOS_NAME:3,BIOS_CODE:16}}},{key:"get",value:function get(a){if(a<16){return(0,_get3.default)((0,_getPrototypeOf2.default)(BIOS.prototype),"get",this).call(this,a)}else if(a>=16&&a<this._code.length+16){return this._code[a-16]}return 0}},{key:"set",value:function set(a,v){if(a<16){(0,_get3.default)((0,_getPrototypeOf2.default)(BIOS.prototype),"set",this).call(this,a,v)}}}]);return BIOS}(_device2.default);exports.default=BIOS},{"./device":83,"babel-runtime/core-js/object/get-prototype-of":6,"babel-runtime/helpers/classCallCheck":10,"babel-runtime/helpers/createClass":11,"babel-runtime/helpers/get":12,"babel-runtime/helpers/inherits":13,"babel-runtime/helpers/possibleConstructorReturn":14}],80:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var chars=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,24,24,24,8,8,0,8,0],[0,20,20,0,0,0,0,0,0],[0,0,20,62,20,62,20,0,0],[0,8,30,48,28,6,60,8,0],[0,0,50,54,12,24,54,38,0],[0,24,52,60,24,58,54,28,0],[0,8,8,0,0,0,0,0,0],[0,12,24,24,24,24,24,12,0],[0,24,12,12,12,12,12,24,0],[0,0,20,8,62,8,20,0,0],[0,0,8,8,62,8,8,0,0],[0,0,0,0,0,0,12,8,0],[0,0,0,0,62,0,0,0,0],[0,0,0,0,0,0,12,12,0],[0,12,12,24,24,24,48,48,0],[0,28,50,50,58,50,50,28,0],[0,12,28,44,12,12,12,62,0],[0,28,54,6,4,8,16,62,0],[0,28,38,6,12,6,38,28,0],[0,12,28,44,44,62,12,12,0],[0,62,48,48,60,6,6,60,0],[0,28,50,48,60,50,50,28,0],[0,62,6,6,12,24,48,48,0],[0,28,50,50,28,50,50,28,0],[0,28,50,50,30,2,50,28,0],[0,0,0,12,0,12,0,0,0],[0,0,0,0,12,0,12,8,0],[0,6,12,24,48,24,12,6,0],[0,0,0,62,0,62,0,0,0],[0,48,24,12,6,12,24,48,0],[0,28,54,6,4,8,0,8,0],[0,28,50,50,54,54,48,30,0],[0,8,28,50,50,62,50,50,0],[0,60,50,50,62,50,50,60,0],[0,28,50,48,48,48,50,28,0],[0,60,50,50,50,50,50,60,0],[0,62,48,48,60,48,48,62,0],[0,62,48,48,60,48,48,48,0],[0,30,48,48,54,50,50,28,0],[0,50,50,50,62,50,50,50,0],[0,62,12,12,12,12,12,62,0],[0,30,6,6,6,6,38,28,0],[0,50,52,56,48,56,52,50,0],[0,48,48,48,48,48,48,62,0],[0,34,54,62,58,34,50,50,0],[0,50,58,62,62,54,50,50,0],[0,28,50,50,50,50,50,28,0],[0,60,50,50,60,48,48,48,0],[0,28,50,50,50,50,52,24,6],[0,60,50,50,60,56,52,50,0],[0,28,50,48,28,6,38,28,0],[0,62,24,24,24,24,24,24,0],[0,50,50,50,50,50,50,28,0],[0,50,50,50,28,28,8,8,0],[0,50,50,34,42,62,54,34,0],[0,50,50,28,28,28,50,50,0],[0,50,50,62,28,8,8,8,0],[0,62,2,6,12,24,48,62,0],[0,28,24,24,24,24,24,28,0],[0,48,48,24,24,24,12,12,0],[0,28,12,12,12,12,12,28,0],[0,0,0,8,28,50,0,0,0],[0,0,0,0,0,0,0,0,62],[0,24,8,0,0,0,0,0,0],[0,0,0,28,2,30,54,26,0],[0,48,48,60,50,50,50,60,0],[0,0,0,30,48,48,48,30,0],[0,2,2,30,50,50,50,30,0],[0,0,0,28,50,62,48,30,0],[0,12,26,24,60,24,24,24,0],[0,0,0,28,50,50,30,2,60],[0,48,48,60,50,50,50,50,0],[0,12,0,28,12,12,12,30,0],[0,6,0,6,6,6,6,38,28],[0,48,48,50,52,56,52,50,0],[0,28,12,12,12,12,12,62,0],[0,0,0,60,62,42,42,42,0],[0,0,0,60,50,50,50,50,0],[0,0,0,28,50,50,50,28,0],[0,0,0,60,50,50,60,48,48],[0,0,0,28,50,50,30,6,6],[0,0,0,28,50,48,48,48,0],[0,0,0,30,48,28,2,60,0],[0,24,24,60,24,24,26,12,0],[0,0,0,50,50,50,50,30,0],[0,0,0,50,50,54,28,8,0],[0,0,0,34,42,42,62,60,0],[0,0,0,34,20,8,20,34,0],[0,0,0,50,50,50,30,2,60],[0,0,0,62,6,28,48,62,0],[12,24,24,24,48,24,24,24,12],[0,8,8,8,8,8,8,8,0],[24,12,12,12,6,12,12,12,24],[0,0,0,0,10,30,20,0,0],[0,0,0,0,0,0,0,0,0]];exports.default=chars},{}],81:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _get2=require("babel-runtime/helpers/get");var _get3=_interopRequireDefault(_get2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _device=require("../src/device");var _device2=_interopRequireDefault(_device);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var CPU=function(_Device){(0,_inherits3.default)(CPU,_Device);function CPU(motherboard){(0,_classCallCheck3.default)(this,CPU);var _this=(0,_possibleConstructorReturn3.default)(this,(0,_getPrototypeOf2.default)(CPU).call(this));_this._mb=motherboard;_this.reset();_this._stepFunction=_this.initStepFunctions();return _this}(0,_createClass3.default)(CPU,[{key:"reset",value:function reset(){(0,_get3.default)((0,_getPrototypeOf2.default)(CPU.prototype),"reset",this).call(this);this._reg=new Uint32Array(16);this._interruptVector=new Uint32Array(256);this._syscallVector=new Uint32Array(256);this._interruptsPending=[];this.PC=this._mb.get32(this._mb.MB_CPU_INIT)}},{key:"name",value:function name(){return"TinyCPU"}},{key:"hasInterrupt",value:function hasInterrupt(){return true}},{key:"pushInterrupt",value:function pushInterrupt(n){this._interruptsPending.push(n)}},{key:"deviceType",value:function deviceType(){return _device2.default.Type.CPU}},{key:"version",value:function version(){return 0}},{key:"constantList",value:function constantList(){return{CPU_A:16,CPU_B:20,CPU_C:24,CPU_D:28,CPU_E:32,CPU_F:36,CPU_G:40,CPU_H:44,CPU_I:48,CPU_J:52,CPU_K:56,CPU_L:60,CPU_FP:64,CPU_SP:68,CPU_PC:72,CPU_FL:76,CPU_INTERRUPT_VECT:256,CPU_SYSCALL_VECT:1280}}},{key:"get",value:function get(a){if(a<=16){return(0,_get3.default)((0,_getPrototypeOf2.default)(CPU.prototype),"get",this).call(this,a)}else{var v=undefined;if(a<=79){v=this._reg[Math.floor((a-16)/4)]}else if(a>=256&&a<1280){v=this._interruptVector[Math.floor((a-256)/4)]}else if(a>=1280&&a<2303){v=this._syscallVector[Math.floor((a-1280)/4)]}if(v!==undefined){switch(a%4){case 0:return v&255;case 1:return v>>8&255;case 2:return v>>16&255;case 3:return v>>24&255}}}}},{key:"set",value:function set(a,v){if(a<16){(0,_get3.default)((0,_getPrototypeOf2.default)(CPU.prototype),"set",this).call(this,a,v)}else{var r=undefined,arr=undefined;if(a>=16&&a<=79){r=Math.floor((a-16)/4);arr=this._reg}else if(a>=256&&a<1280){r=Math.floor((a-256)/4);arr=this._interruptVector}else if(a>=1280&&a<2303){r=Math.floor((a-1280)/4);arr=this._syscallVector}if(arr){switch(a%4){case 0:arr[r]&=~255;arr[r]|=v;break;case 1:arr[r]&=~65280;arr[r]|=v<<8;break;case 2:arr[r]&=~16711680;arr[r]|=v<<16;break;case 3:arr[r]&=~4278190080;arr[r]|=v<<24;break}}}}},{key:"step",value:function step(){var n=this._stepFunction[this._mb.get(this.PC)](this.PC+1);if(n){this.PC+=n+1}}},{key:"checkInterrupts",value:function checkInterrupts(){if(this.T&&this._interruptsPending.length>0){var n=this._interruptsPending.shift();this._push32(this.PC);this.T=false;this.PC=this._interruptVector[n]}}},{key:"_affectFlags",value:function _affectFlags(value){this.Z=(value&4294967295)===0;this.P=value%2===0;this.S=value>>31&1?true:false;this.V=false;this.Y=false;this.GT=false;this.LT=false;return value&4294967295}},{key:"_push",value:function _push(value){this._mb.set(this.SP,value);this.SP-=1}},{key:"_push16",value:function _push16(value){this.SP-=1;this._mb.set16(this.SP,value);this.SP-=1}},{key:"_push32",value:function _push32(value){this.SP-=3;this._mb.set32(this.SP,value);this.SP-=1}},{key:"_pop",value:function _pop(){this.SP+=1;return this._mb.get(this.SP)}},{key:"_pop16",value:function _pop16(){this.SP+=1;var r=this._mb.get16(this.SP);this.SP+=1;return r}},{key:"_pop32",value:function _pop32(){this.SP+=1;var r=this._mb.get32(this.SP);this.SP+=3;return r}},{key:"initStepFunctions",value:function initStepFunctions(){var _this2=this;var f=[];for(var i=0;i<256;++i){f.push(function(pos){_this2.fireInterrupt();return 0})}f[1]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var r=reg[mb.get(pos+1)];reg[mb.get(pos)]=_this2._affectFlags(r);return 2};f[2]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var r=mb.get(pos+1);reg[mb.get(pos)]=_this2._affectFlags(r);return 2};f[3]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var r=mb.get16(pos+1);reg[mb.get(pos)]=_this2._affectFlags(r);return 3};f[4]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var r=mb.get32(pos+1);reg[mb.get(pos)]=_this2._affectFlags(r);return 5};f[5]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);var r=mb.get(reg[p2]);reg[p1]=_this2._affectFlags(r);return 2};f[6]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get32(pos+1);var r=mb.get(p2);reg[p1]=_this2._affectFlags(r);return 5};f[11]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);var r=reg[p2]&255;mb.set(reg[p1],_this2._affectFlags(r));return 2};f[12]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);var r=p2;mb.set(reg[p1],_this2._affectFlags(r));return 2};f[13]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);var r=mb.get(reg[p2]);mb.set(reg[p1],_this2._affectFlags(r));return 2};f[14]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get32(pos+1);var r=mb.get(p2);mb.set(reg[p1],_this2._affectFlags(r));return 5};f[33]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get32(pos);var p2=mb.get(pos+4);var r=reg[p2]&255;mb.set(p1,_this2._affectFlags(r));return 5};f[34]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get32(pos);var p2=mb.get(pos+4);var r=p2;mb.set(p1,_this2._affectFlags(r));return 5};f[35]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get32(pos);var p2=mb.get(pos+4);var r=mb.get(reg[p2]);mb.set(p1,_this2._affectFlags(r));return 5};f[36]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get32(pos);var p2=mb.get32(pos+4);var r=mb.get(mb.get32(p2));mb.set(p1,_this2._affectFlags(r));return 8};f[7]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);var r=mb.get16(reg[p2]);reg[p1]=_this2._affectFlags(r);return 2};f[8]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get32(pos+1);var r=mb.get16(p2);reg[p1]=_this2._affectFlags(r);return 5};f[15]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);var r=reg[p2]&65535;mb.set16(reg[p1],_this2._affectFlags(r));return 2};f[26]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get16(pos+1);var r=p2;mb.set16(reg[p1],_this2._affectFlags(r));return 3};f[27]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);var r=mb.get16(reg[p2]);mb.set16(reg[p1],_this2._affectFlags(r));return 2};f[28]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get32(pos+1);var r=mb.get16(p2);mb.set16(reg[p1],_this2._affectFlags(r));return 5};f[37]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get32(pos);var p2=mb.get(pos+4);var r=reg[p2]&65535;mb.set16(p1,_this2._affectFlags(r));return 5};f[38]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get32(pos);var p2=mb.get16(pos+4);var r=p2;mb.set16(p1,_this2._affectFlags(r));return 6};f[39]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get32(pos);var p2=mb.get(pos+4);mb.set16(p1,mb.get16(reg[p2]));return 5};f[40]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get32(pos);var p2=mb.get32(pos+4);mb.set16(p1,mb.get16(mb.get32(p2)));return 8};f[9]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);var r=mb.get32(reg[p2]);reg[p1]=_this2._affectFlags(r);return 2};f[10]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get32(pos+1);var r=mb.get32(p2);reg[p1]=_this2._affectFlags(r);return 5};f[29]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);var r=reg[p2];mb.set32(reg[p1],_this2._affectFlags(r));return 2};f[30]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get32(pos+1);var r=p2;mb.set32(reg[p1],_this2._affectFlags(r));return 5};f[31]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);var r=mb.get32(reg[p2]);mb.set32(reg[p1],_this2._affectFlags(r));return 2};f[32]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get32(pos+1);var r=mb.get32(p2);mb.set32(reg[p1],_this2._affectFlags(r));return 5};f[41]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get32(pos);var p2=mb.get(pos+4);var r=reg[p2];mb.set32(p1,_this2._affectFlags(r));return 5};f[42]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get32(pos);var p2=mb.get32(pos+4);var r=p2;debugger;mb.set32(p1,_this2._affectFlags(r));return 8};f[43]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get32(pos);var p2=mb.get(pos+4);var r=mb.get32(reg[p2]);mb.set32(p1,_this2._affectFlags(r));return 5};f[44]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get32(pos);var p2=mb.get32(pos+4);var r=mb.get32(mb.get32(p2));mb.set32(p1,_this2._affectFlags(r));return 8};f[45]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);var r=reg[p1]|reg[p2];reg[p1]=_this2._affectFlags(r);return 2};f[46]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);var r=reg[p1]|p2;reg[p1]=_this2._affectFlags(r);return 2};f[47]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get16(pos+1);var r=reg[p1]|p2;reg[p1]=_this2._affectFlags(r);return 3};f[48]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get32(pos+1);var r=reg[p1]|p2;reg[p1]=_this2._affectFlags(r);return 5};f[49]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);var r=reg[p1]^reg[p2];reg[p1]=_this2._affectFlags(r);return 2};f[50]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);var r=reg[p1]^p2;reg[p1]=_this2._affectFlags(r);return 2};f[51]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get16(pos+1);var r=reg[p1]^p2;reg[p1]=_this2._affectFlags(r);return 3};f[52]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get32(pos+1);var r=reg[p1]^p2;reg[p1]=_this2._affectFlags(r);return 5};f[53]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);var r=reg[p1]&reg[p2];reg[p1]=_this2._affectFlags(r);return 2};f[54]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);var r=reg[p1]&p2;reg[p1]=_this2._affectFlags(r);return 2};f[55]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get16(pos+1);var r=reg[p1]&p2;reg[p1]=_this2._affectFlags(r);return 3};f[56]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get32(pos+1);var r=reg[p1]&p2;reg[p1]=_this2._affectFlags(r);return 5};f[57]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);var r=reg[p1]<<reg[p2];reg[p1]=_this2._affectFlags(r);_this2.Y=(reg[p1]>>31&1)==1;return 2};f[58]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);var r=reg[p1]<<p2;reg[p1]=_this2._affectFlags(r);_this2.Y=(reg[p1]>>31&1)==1;return 2};f[61]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);var r=reg[p1]>>reg[p2];reg[p1]=_this2._affectFlags(r);_this2.Y=(reg[p1]&1)==1;return 2};f[62]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);var r=reg[p1]>>p2;reg[p1]=_this2._affectFlags(r);_this2.Y=(reg[p1]&1)==1;return 2};f[65]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var r=~reg[p1];reg[p1]=_this2._affectFlags(r);return 1};f[66]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);var r=reg[p1]+reg[p2]+(_this2.Y?1:0);reg[p1]=_this2._affectFlags(r);return 2};f[67]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);var r=reg[p1]+p2+(_this2.Y?1:0);reg[p1]=_this2._affectFlags(r);_this2.Y=r>4294967295;return 2};f[68]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get16(pos+1);var r=reg[p1]+p2+(_this2.Y?1:0);reg[p1]=_this2._affectFlags(r);_this2.Y=r>4294967295;return 3};f[69]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get32(pos+1);var r=reg[p1]+p2+(_this2.Y?1:0);reg[p1]=_this2._affectFlags(r);_this2.Y=r>4294967295;return 5};f[70]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);var r=reg[p1]-reg[p2]-(_this2.Y?1:0);reg[p1]=_this2._affectFlags(r);_this2.Y=r<0;return 2};f[71]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);var r=reg[p1]-p2-(_this2.Y?1:0);reg[p1]=_this2._affectFlags(r);_this2.Y=r<0;return 2};f[72]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get16(pos+1);var r=reg[p1]-p2-(_this2.Y?1:0);reg[p1]=_this2._affectFlags(r);_this2.Y=r<0;return 3};f[73]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get32(pos+1);var r=reg[p1]-p2-(_this2.Y?1:0);reg[p1]=_this2._affectFlags(r);_this2.Y=r<0;return 5};f[74]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);_this2._affectFlags(reg[p1]-reg[p2],32);_this2.LT=reg[p1]<reg[p2];_this2.GT=reg[p1]>reg[p2];_this2.Y=reg[p1]-reg[p2]<0;return 2};f[75]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);_this2._affectFlags(reg[p1]-p2,8);_this2.LT=reg[p1]<p2;_this2.GT=reg[p1]>p2;_this2.Y=reg[p1]-p2<0;return 2};f[76]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get16(pos+1);_this2._affectFlags(reg[p1]-p2,16);_this2.LT=reg[p1]<p2;_this2.GT=reg[p1]>p2;_this2.Y=reg[p1]-p2<0;return 3};f[77]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get32(pos+1);_this2._affectFlags(reg[p1]-p2,32);_this2.LT=reg[p1]<p2;_this2.GT=reg[p1]>p2;_this2.Y=reg[p1]-p2<0;return 5};f[78]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);var r=reg[p1]*reg[p2];reg[p1]=_this2._affectFlags(r);_this2.V=r>4294967295;return 2};f[79]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);var r=reg[p1]*p2;reg[p1]=_this2._affectFlags(r);_this2.V=r>4294967295;return 2};f[80]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get16(pos+1);var r=reg[p1]*p2;reg[p1]=_this2._affectFlags(r);_this2.V=r>4294967295;return 3};f[81]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get32(pos+1);var r=reg[p1]*p2;reg[p1]=_this2._affectFlags(r);_this2.V=r>4294967295;return 5};f[82]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);var r=Math.floor(reg[p1]/reg[p2]);reg[p1]=_this2._affectFlags(r);return 2};f[83]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);var r=Math.floor(reg[p1]/p2);reg[p1]=_this2._affectFlags(r);return 2};f[84]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get16(pos+1);var r=Math.floor(reg[p1]/p2);reg[p1]=_this2._affectFlags(r);return 3};f[85]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get32(pos+1);var r=Math.floor(reg[p1]/p2);reg[p1]=_this2._affectFlags(r);return 5};f[86]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);var r=reg[p1]%reg[p2];reg[p1]=_this2._affectFlags(r);return 2};f[87]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get(pos+1);var r=reg[p1]%p2;reg[p1]=_this2._affectFlags(r);return 2};f[88]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get16(pos+1);var r=reg[p1]%p2;reg[p1]=_this2._affectFlags(r);return 3};f[89]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var p2=mb.get32(pos+1);var r=reg[p1]%p2;reg[p1]=_this2._affectFlags(r);return 5};f[90]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var r=reg[p1]+1;reg[p1]=_this2._affectFlags(r);_this2.Y=r>4294967295;return 1};f[91]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);var r=reg[p1]-1;reg[p1]=_this2._affectFlags(r);_this2.Y=r<0;return 1};f[92]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);if(_this2.Z){_this2.PC=reg[p1];return 0}return 1};f[93]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get32(pos);if(_this2.Z){_this2.PC=p1;return 0}return 4};f[94]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);if(!_this2.Z){_this2.PC=reg[p1];return 0}return 1};f[95]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get32(pos);if(!_this2.Z){_this2.PC=p1;return 0}return 4};f[96]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);if(_this2.S){_this2.PC=reg[p1];return 0}return 1};f[97]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get32(pos);if(_this2.S){_this2.PC=p1;return 0}return 4};f[98]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);if(!_this2.S){_this2.PC=reg[p1];return 0}return 1};f[99]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get32(pos);if(!_this2.S){_this2.PC=p1;return 0}return 4};f[100]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);if(_this2.GT){_this2.PC=reg[p1];return 0}return 1};f[101]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get32(pos);if(_this2.GT){_this2.PC=p1;return 0}return 4};f[102]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);if(_this2.GT&&_this2.Z){_this2.PC=reg[p1];return 0}return 1};f[103]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get32(pos);if(_this2.GT&&_this2.Z){_this2.PC=p1;return 0}return 4};f[104]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);if(_this2.LT){_this2.PC=reg[p1];return 0}return 1};f[105]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get32(pos);if(_this2.LT){_this2.PC=p1;return 0}return 4};f[106]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);if(_this2.LT&&_this2.Z){_this2.PC=reg[p1];return 0}return 1};f[107]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get32(pos);if(_this2.LT&&_this2.Z){_this2.PC=p1;return 0}return 4};f[108]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);if(_this2.V){_this2.PC=reg[p1];return 0}return 1};f[109]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get32(pos);if(_this2.V){_this2.PC=p1;return 0}return 4};f[110]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get(pos);if(!_this2.V){_this2.PC=reg[p1];return 0}return 1};f[111]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=mb.get32(pos);if(!_this2.V){_this2.PC=p1;return 0}return 4};f[112]=function(pos){var reg=_this2._reg;var mb=_this2._mb;var p1=_this2._mb.get(pos);_this2.PC=_this2._reg[p1];return 0};f[113]=function(pos){var p1=_this2._mb.get32(pos);_this2.PC=p1;return 0};f[114]=function(pos){var p1=_this2._mb.get(pos);_this2._push32(_this2.PC+2);_this2.PC=_this2._reg[p1];return 0};f[115]=function(pos){var p1=_this2._mb.get32(pos);_this2._push32(_this2.PC+5);_this2.PC=p1;return 0};f[116]=function(pos){_this2.PC=_this2._pop32();return 0};f[117]=function(pos){var p1=_this2._mb.get(pos);_this2._push32(_this2.PC+2);_this2.PC=_this2._syscallVector[_this2._reg[p1]&255];return 0};f[118]=function(pos){var p1=_this2._mb.get(pos);_this2._push32(_this2.PC+2);_this2.PC=_this2._syscallVector[p1];return 0};f[119]=function(pos){_this2.PC=_this2._pop32();_this2.T=true;return 0};f[134]=function(pos){_this2.PC=_this2._pop32();return 0};f[120]=function(pos){var p1=_this2._mb.get(pos);_this2._push(_this2._reg[p1]&255);return 1};f[121]=function(pos){var p1=_this2._mb.get(pos);_this2._push(p1);return 1};f[122]=function(pos){var p1=_this2._mb.get(pos);_this2._push16(_this2._reg[p1]&65535);return 1};f[123]=function(pos){var p1=_this2._mb.get16(pos);_this2._push16(p1);return 2};f[124]=function(pos){var p1=_this2._mb.get(pos);_this2._push32(_this2._reg[p1]);return 1};f[125]=function(pos){var p1=_this2._mb.get32(pos);_this2._push32(p1);return 4};f[126]=function(pos){for(var i=0;i<=11;++i){_this2._push32(_this2._reg[i])}return 0};f[127]=function(pos){var p1=_this2._mb.get(pos);_this2._reg[p1]=_this2._pop();return 1};f[128]=function(pos){var p1=_this2._mb.get(pos);_this2._reg[p1]=_this2._pop16();return 1};f[129]=function(pos){var p1=_this2._mb.get(pos);_this2._reg[p1]=_this2._pop32();return 1};f[130]=function(pos){for(var i=11;i>=0;--i){_this2._reg[i]=_this2._pop32()}return 0};f[131]=function(pos){var p1=_this2._mb.get(pos);for(var i=0;i<_this2._reg[p1];++i){_this2._pop()}return 1};f[132]=function(pos){var p1=_this2._mb.get(pos);for(var i=0;i<p1;++i){_this2._pop()}return 1};f[133]=function(pos){var p1=_this2._mb.get16(pos);for(var i=0;i<p1;++i){_this2._pop()}return 2};f[135]=function(pos){return 0};return f}},{key:"A",get:function get(){return this._reg[0]},set:function set(v){this._reg[0]=v}},{key:"B",get:function get(){return this._reg[1]},set:function set(v){this._reg[1]=v}},{key:"C",get:function get(){return this._reg[2]},set:function set(v){this._reg[2]=v}},{key:"D",get:function get(){return this._reg[3]},set:function set(v){this._reg[3]=v}},{key:"E",get:function get(){return this._reg[4]},set:function set(v){this._reg[4]=v}},{key:"F",get:function get(){return this._reg[5]},set:function set(v){this._reg[5]=v}},{key:"G",get:function get(){return this._reg[6]},set:function set(v){this._reg[6]=v}},{key:"H",get:function get(){return this._reg[7]},set:function set(v){this._reg[7]=v}},{key:"I",get:function get(){return this._reg[8]},set:function set(v){this._reg[8]=v}},{key:"J",get:function get(){return this._reg[9]},set:function set(v){this._reg[9]=v}},{key:"K",get:function get(){return this._reg[10]},set:function set(v){this._reg[10]=v}},{key:"L",get:function get(){return this._reg[11]},set:function set(v){this._reg[11]=v}},{key:"FP",get:function get(){return this._reg[12]},set:function set(v){this._reg[12]=v}},{key:"SP",get:function get(){return this._reg[13]},set:function set(v){this._reg[13]=v&4294967295}},{key:"PC",get:function get(){return this._reg[14]},set:function set(v){this._reg[14]=v}},{key:"FL",get:function get(){return this._reg[15]},set:function set(v){this._reg[15]=v}},{key:"Y",get:function get(){return this._reg[15]&1?true:false},set:function set(v){if(v)this._reg[15]|=1<<0;else this._reg[15]&=~(1<<0)}},{key:"V",get:function get(){return this._reg[15]>>1&1?true:false},set:function set(v){if(v)this._reg[15]|=1<<1;else this._reg[15]&=~(1<<1)}},{key:"Z",get:function get(){return this._reg[15]>>2&1?true:false},set:function set(v){if(v)this._reg[15]|=1<<2;else this._reg[15]&=~(1<<2)}},{key:"S",get:function get(){return this._reg[15]>>3&1?true:false},set:function set(v){if(v)this._reg[15]|=1<<3;else this._reg[15]&=~(1<<3)}},{key:"GT",get:function get(){return this._reg[15]>>4&1?true:false},set:function set(v){if(v)this._reg[15]|=1<<4;else this._reg[15]&=~(1<<4)}},{key:"LT",get:function get(){return this._reg[15]>>5&1?true:false},set:function set(v){if(v){this._reg[15]|=1<<5}else{this._reg[15]&=~(1<<5)}}},{key:"P",get:function get(){return this._reg[15]>>6&1?true:false},set:function set(v){if(v){this._reg[15]|=1<<6}else{this._reg[15]&=~(1<<6)}}},{key:"T",get:function get(){return this._reg[15]>>7&1?true:false},set:function set(v){if(v){this._reg[15]|=1<<7}else{this._reg[15]&=~(1<<6)}}}],[{key:"encode",value:function encode(s){function registerValue(r){switch(r){case"a":return 0;case"b":return 1;case"c":return 2;case"d":return 3;case"e":return 4;case"f":return 5;case"g":return 6;case"h":return 7;case"i":return 8;case"j":return 9;case"k":return 10;case"l":return 11;case"fp":return 12;case"sp":return 13;case"pc":return 14;case"fl":return 15;default:throw new Error("Invalid register "+r)}}var m=s.match(/^\s*([a-z\.]+)(?:\s+(\[?(?:[a-l]|fp|sp|pc|fl|0x[0-9a-f]+|[0-9]+)\]?))?(?:\s*,\s*(\[?(?:[a-l]|fp|sp|pc|fl|0x[0-9a-f]+|[0-9]+)\]?))?\s*$/i);if(!m){throw new Error("Invalid command `"+s+"`")}var cmd={opcode:m[1],pars:[]};for(var i=2;i<m.length;++i){if(m[i]==undefined){continue}var type=undefined;var _value=undefined;var size=undefined;var valArray=[];if(m[i][0]==="["){if(m[i].slice(-1)!=="]"){throw new Error("Unbalanced bracket in "+m[i])}if(m[i][1].charCodeAt(0)>"9".charCodeAt(0)){type="indirect register";_value=registerValue(m[i].slice(1,-1).toLowerCase());size=8;valArray=[_value]}else{type="indirect value";_value=parseInt(m[i].slice(1,-1));size=32;valArray=[_value&255,_value>>8&255,_value>>16&255,_value>>24&255]}}else if(m[i].charCodeAt(0)>"9".charCodeAt(0)){type="register";_value=registerValue(m[i].toLowerCase());size=8;valArray=[_value]}else{type="value";_value=parseInt(m[i]);if(_value<=255){size=8;valArray=[_value]}else if(_value<=65535){size=16;valArray=[_value&255,_value>>8]}else{size=32;valArray=[_value&255,_value>>8&255,_value>>16&255,_value>>24&255]}}cmd.pars.push({
type:type,value:_value,size:size,valArray:valArray})}try{var t0=cmd.pars[0].type;var v0=cmd.pars[0].value;var a0=cmd.pars[0].valArray;var s0=cmd.pars[0].size}catch(e){if(e instanceof TypeError){var t0="none";var v0=0;var a0=[];var s0=0}else{throw e}}try{var t1=cmd.pars[1].type;var v1=cmd.pars[1].value;var a1=cmd.pars[1].valArray;var s1=cmd.pars[1].size}catch(e){if(e instanceof TypeError){var t1="none";var v1=0;var a1=[];var s1=0}else{throw e}}var opcode=null;switch(cmd.opcode){case"mov":if(t0==="register"&&t1!=="none"){if(t1==="register"){opcode=1}else if(t1==="value"){switch(s1){case 8:opcode=2;break;case 16:opcode=3;break;case 32:opcode=4;break}}if(opcode){return[opcode,v0].concat(a1)}}break;case"movb":if(t0==="register"){switch(t1){case"indirect register":opcode=5;break;case"indirect value":opcode=6;break}}else if(t0==="indirect register"){switch(t1){case"register":opcode=11;break;case"value":if(s1<=8){opcode=12}break;case"indirect register":opcode=13;break;case"indirect value":opcode=14;break}}else if(t0==="indirect value"){switch(t1){case"register":opcode=33;break;case"value":if(s1<=8){opcode=34}break;case"indirect register":opcode=35;break;case"indirect value":opcode=36;break}}if(opcode){return[opcode].concat(a0).concat(a1)}break;case"movw":if(t0==="register"){switch(t1){case"indirect register":opcode=7;break;case"indirect value":opcode=8;break}}else if(t0==="indirect register"){switch(t1){case"register":opcode=15;break;case"value":if(s1<=16){return[26].concat(a0).concat([v1&255,v1>>8])}break;case"indirect register":opcode=27;break;case"indirect value":opcode=28;break}}else if(t0==="indirect value"){switch(t1){case"register":opcode=37;break;case"value":if(s1<=16){return[38].concat(a0).concat([v1&255,v1>>8])}break;case"indirect register":opcode=39;break;case"indirect value":opcode=40;break}}if(opcode){return[opcode].concat(a0).concat(a1)}break;case"movd":if(t0==="register"){switch(t1){case"indirect register":opcode=9;break;case"indirect value":opcode=10;break}}else if(t0==="indirect register"){switch(t1){case"register":opcode=29;break;case"value":return[30].concat(a0).concat([v1&255,v1>>8&255,v1>>16&255,v1>>24&255]);case"indirect register":opcode=31;break;case"indirect value":opcode=32;break}}else if(t0==="indirect value"){switch(t1){case"register":opcode=41;break;case"value":return[42].concat(a0).concat([v1&255,v1>>8&255,v1>>16&255,v1>>24&255]);case"indirect register":opcode=43;break;case"indirect value":opcode=44;break}}if(opcode){return[opcode].concat(a0).concat(a1)}break;case"or":if(t0==="register"){if(t1==="register"){return[45].concat(a0).concat(a1)}else if(t1==="value"&&s1===8){return[46].concat(a0).concat(a1)}else if(t1==="value"&&s1===16){return[47].concat(a0).concat(a1)}else if(t1==="value"&&s1===32){return[48].concat(a0).concat(a1)}}break;case"xor":if(t0==="register"){if(t1==="register"){return[49].concat(a0).concat(a1)}else if(t1==="value"&&s1===8){return[50].concat(a0).concat(a1)}else if(t1==="value"&&s1===16){return[51].concat(a0).concat(a1)}else if(t1==="value"&&s1===32){return[52].concat(a0).concat(a1)}}break;case"and":if(t0==="register"){if(t1==="register"){return[53].concat(a0).concat(a1)}else if(t1==="value"&&s1===8){return[54].concat(a0).concat(a1)}else if(t1==="value"&&s1===16){return[55].concat(a0).concat(a1)}else if(t1==="value"&&s1===32){return[56].concat(a0).concat(a1)}}break;case"shl":if(t0==="register"){if(t1==="register"){return[57].concat(a0).concat(a1)}else if(t1==="value"&&s1===8){return[58].concat(a0).concat(a1)}}break;case"shr":if(t0==="register"){if(t1==="register"){return[61].concat(a0).concat(a1)}else if(t1==="value"&&s1===8){return[62].concat(a0).concat(a1)}}break;case"not":if(t0==="register"&&t1==="none"){return[65].concat(a0)}break;case"add":if(t0==="register"){if(t1==="register"){return[66].concat(a0).concat(a1)}else if(t1==="value"&&s1===8){return[67].concat(a0).concat(a1)}else if(t1==="value"&&s1===16){return[68].concat(a0).concat(a1)}else if(t1==="value"&&s1===32){return[69].concat(a0).concat(a1)}}break;case"sub":if(t0==="register"){if(t1==="register"){return[70].concat(a0).concat(a1)}else if(t1==="value"&&s1===8){return[71].concat(a0).concat(a1)}else if(t1==="value"&&s1===16){return[72].concat(a0).concat(a1)}else if(t1==="value"&&s1===32){return[73].concat(a0).concat(a1)}}break;case"cmp":if(t0==="register"){if(t1==="register"){return[74].concat(a0).concat(a1)}else if(t1==="value"&&s1===8){return[75].concat(a0).concat(a1)}else if(t1==="value"&&s1===16){return[76].concat(a0).concat(a1)}else if(t1==="value"&&s1===32){return[77].concat(a0).concat(a1)}}break;case"mul":if(t0==="register"){if(t1==="register"){return[78].concat(a0).concat(a1)}else if(t1==="value"&&s1===8){return[79].concat(a0).concat(a1)}else if(t1==="value"&&s1===16){return[80].concat(a0).concat(a1)}else if(t1==="value"&&s1===32){return[81].concat(a0).concat(a1)}}break;case"idiv":if(t0==="register"){if(t1==="register"){return[82].concat(a0).concat(a1)}else if(t1==="value"&&s1===8){return[83].concat(a0).concat(a1)}else if(t1==="value"&&s1===16){return[84].concat(a0).concat(a1)}else if(t1==="value"&&s1===32){return[85].concat(a0).concat(a1)}}break;case"mod":if(t0==="register"){if(t1==="register"){return[86].concat(a0).concat(a1)}else if(t1==="value"&&s1===8){return[87].concat(a0).concat(a1)}else if(t1==="value"&&s1===16){return[88].concat(a0).concat(a1)}else if(t1==="value"&&s1===32){return[89].concat(a0).concat(a1)}}break;case"inc":if(t0==="register"&&t1==="none"){return[90].concat(a0)}break;case"dec":if(t0==="register"&&t1==="none"){return[91].concat(a0)}break;case"bz":case"beq":if(t0==="register"&&t1==="none"){return[92].concat(a0)}else if(t0==="value"&&t1==="none"){return[93,v0&255,v0>>8&255,v0>>16&255,v0>>24&255]}break;case"bnz":case"bneq":if(t0==="register"&&t1==="none"){return[94].concat(a0)}else if(t0==="value"&&t1==="none"){return[95,v0&255,v0>>8&255,v0>>16&255,v0>>24&255]}break;case"bneg":if(t0==="register"&&t1==="none"){return[96].concat(a0)}else if(t0==="value"&&t1==="none"){return[97,v0&255,v0>>8&255,v0>>16&255,v0>>24&255]}break;case"bpos":if(t0==="register"&&t1==="none"){return[98].concat(a0)}else if(t0==="value"&&t1==="none"){return[99,v0&255,v0>>8&255,v0>>16&255,v0>>24&255]}break;case"bgt":if(t0==="register"&&t1==="none"){return[100].concat(a0)}else if(t0==="value"&&t1==="none"){return[101,v0&255,v0>>8&255,v0>>16&255,v0>>24&255]}break;case"bgte":if(t0==="register"&&t1==="none"){return[102].concat(a0)}else if(t0==="value"&&t1==="none"){return[103,v0&255,v0>>8&255,v0>>16&255,v0>>24&255]}break;case"blt":if(t0==="register"&&t1==="none"){return[104].concat(a0)}else if(t0==="value"&&t1==="none"){return[105,v0&255,v0>>8&255,v0>>16&255,v0>>24&255]}break;case"blte":if(t0==="register"&&t1==="none"){return[106].concat(a0)}else if(t0==="value"&&t1==="none"){return[107,v0&255,v0>>8&255,v0>>16&255,v0>>24&255]}break;case"bv":if(t0==="register"&&t1==="none"){return[108].concat(a0)}else if(t0==="value"&&t1==="none"){return[109,v0&255,v0>>8&255,v0>>16&255,v0>>24&255]}break;case"bnv":if(t0==="register"&&t1==="none"){return[110].concat(a0)}else if(t0==="value"&&t1==="none"){return[111,v0&255,v0>>8&255,v0>>16&255,v0>>24&255]}break;case"jmp":if(t0==="register"&&t1==="none"){return[112].concat(a0)}else if(t0==="value"&&t1==="none"){return[113,v0&255,v0>>8&255,v0>>16&255,v0>>24&255]}break;case"jsr":if(t0==="register"&&t1==="none"){return[114].concat(a0)}else if(t0==="value"&&t1==="none"){return[115,v0&255,v0>>8&255,v0>>16&255,v0>>24&255]}break;case"ret":if(t0==="none"&&t1==="none"){return[116]}break;case"sys":if(t0==="register"&&t1==="none"){return[117].concat(a0)}else if(t0==="value"&&s0===8&&t1==="none"){return[118,v0]}break;case"iret":if(t0==="none"&&t1==="none"){return[119]}break;case"sret":if(t0==="none"&&t1==="none"){return[134]}break;case"pushb":if(t0==="register"&&t1==="none"){return[120].concat(a0)}else if(t0==="value"&&s0<=8&&t1==="none"){return[121].concat(a0)}break;case"pushw":if(t0==="register"&&t1==="none"){return[122].concat(a0)}else if(t0===value&&s0<=16&&t1==="none"){return[123].concat([v0&255,v0>>8])}break;case"pushd":if(t0==="register"&&t1==="none"){return[124].concat(a0)}else if(t0==="value"&&s0<=16&&t1==="none"){return[125].concat([v0&255,v0>>8&255,v0>>16&255,v0>>24&255])}break;case"push.a":if(t0==="none"&&t1==="none"){return[126]}break;case"popb":if(t0==="register"&&t1==="none"){return[127].concat(a0)}break;case"popw":if(t0==="register"&&t1==="none"){return[128].concat(a0)}break;case"popd":if(t0==="register"&&t1==="none"){return[129].concat(a0)}break;case"pop.a":if(t0==="none"&&t1==="none"){return[130]}break;case"popx":if(t0==="register"&&t1==="none"){return[131].concat(a0)}else if(t0==="value"&&s0<=8&&t1==="none"){return[132].concat(a0)}else if(t0==="value"&&s0<=16&&t1==="none"){return[133].concat(a0)}break;case"nop":if(t0==="none"&&t1==="none"){return[135]}break}throw new Error("Invalid command '"+s+"'")}}]);return CPU}(_device2.default);exports.default=CPU},{"../src/device":83,"babel-runtime/core-js/object/get-prototype-of":6,"babel-runtime/helpers/classCallCheck":10,"babel-runtime/helpers/createClass":11,"babel-runtime/helpers/get":12,"babel-runtime/helpers/inherits":13,"babel-runtime/helpers/possibleConstructorReturn":14}],82:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _toArray2=require("babel-runtime/helpers/toArray");var _toArray3=_interopRequireDefault(_toArray2);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function h(n,digits){return(Array(digits||0).join("0")+n.toString(16)).substr(-digits).toUpperCase()}var Debugger=function(){function Debugger(tinyvm){(0,_classCallCheck3.default)(this,Debugger);this._vm=tinyvm}(0,_createClass3.default)(Debugger,[{key:"parse",value:function parse(s){var _s$split=s.split(" ");var _s$split2=(0,_toArray3.default)(_s$split);var cmd=_s$split2[0];var pars=_s$split2.slice(1);switch(cmd){case"?":case"h":return this._help();case"r":return this._registers();case"s":return this._step();default:return"syntax error (use [?] for help)"}}},{key:"_help",value:function _help(){return"CPU:\n  [r] Registers\n  [s] step through\n  [o] step over\n  [c] continue execution\n  [s]/[u] set/unset breakpoint ([address=PC])\n  [l] disassemly ([address=PC])\n\nMemory:\n  [d] dump memory block     (address [size=0x100])\n  [e] enter memory data     (address value)\n  [f] fill memory with data (address size value)\n  [c] copy memory block     (origin destination size)\n  [p] search for pattern    (pattern [beginning [end]])\n  [v] virtual memory info\n\nOther:\n  [t] dump video text"}},{key:"_registers",value:function _registers(){var c=this._vm.cpu;return"A: "+h(c.A,8)+"    E: "+h(c.E,8)+"    I: "+h(c.I,8)+"    FP: "+h(c.FP,8)+"\nB: "+h(c.B,8)+"    F: "+h(c.F,8)+"    J: "+h(c.J,8)+"    SP: "+h(c.SP,8)+"\nC: "+h(c.C,8)+"    G: "+h(c.G,8)+"    K: "+h(c.K,8)+"    PC: "+h(c.PC,8)+"\nD: "+h(c.D,8)+"    H: "+h(c.H,8)+"    L: "+h(c.L,8)+"    FL: "+h(c.FL,8)+"\n\nFlags => Y:"+(c.Y?1:0)+"  V:"+(c.V?1:0)+"  Z:"+(c.Z?1:0)+"  S:"+(c.S?1:0)+"  GT:"+(c.GT?1:0)+"  LT:"+(c.LT?1:0)+"  P:"+(c.P?1:0)+"  T:"+(c.T?1:0)}},{key:"_step",value:function _step(){this._vm.step();return""}}]);return Debugger}();exports.default=Debugger},{"babel-runtime/helpers/classCallCheck":10,"babel-runtime/helpers/createClass":11,"babel-runtime/helpers/toArray":15}],83:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _lsbstorage=require("./lsbstorage");var _lsbstorage2=_interopRequireDefault(_lsbstorage);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Device=function(_LSBStorage){(0,_inherits3.default)(Device,_LSBStorage);function Device(){(0,_classCallCheck3.default)(this,Device);var _this=(0,_possibleConstructorReturn3.default)(this,(0,_getPrototypeOf2.default)(Device).call(this));_this.interruptNumber=0;_this.mb=null;if(_this.constructor===_lsbstorage2.default){throw new TypeError("Abstact class cannot be instantiated.")}if(_this.name().length>13){throw new Error("Name must not be longer than 13 bytes")}var found=false;for(var d in Device.Type){if(Device.Type[d]===_this.deviceType()){found=true}}if(!found){throw new Error('Invalid device type "'+_this.deviceType()+'"')}if(_this.version()>255){throw new Error("Maximum version is 0xFF")}if(_this.memorySize()<4096){throw new Error("Memory must be at least 0x1000 bytes.")}return _this}(0,_createClass3.default)(Device,[{key:"initializeConstants",value:function initializeConstants(addr){var ks=this.constantList();for(var k in ks){this[k]=ks[k]+addr}}},{key:"name",value:function name(){throw new Error("Implement this method")}},{key:"deviceType",value:function deviceType(){throw new Error("Implement this method")}},{key:"version",value:function version(){throw new Error("Implement this method")}},{key:"memorySize",value:function memorySize(){return 4096}},{key:"hasInterrupt",value:function hasInterrupt(){return false}},{key:"constantList",value:function constantList(){return{}}},{key:"fireInterrupt",value:function fireInterrupt(){if(this.mb){this.mb.pushInterrupt(this.interruptNumber)}}},{key:"step",value:function step(cycles){}},{key:"reset",value:function reset(){}},{key:"get",value:function get(a){switch(a){case 0:return this.deviceType();case 1:return this.version();case 2:return this.interruptNumber}if(a>=3&&a<=15){return this.name().charCodeAt(a-3)}return 0}},{key:"set",value:function set(a){}}]);return Device}(_lsbstorage2.default);exports.default=Device;Device.Type={MOTHERBOARD:0,MMU:1,CPU:2,STORAGE:3,KEYBOARD:4,TIMER:5,BIOS:6,VIDEO:7,OTHER_INPUT:128,OTHER_OUTPUT:129,RAM:253,MOTHERBOARD:254,UNUSED:255}},{"./lsbstorage":86,"babel-runtime/core-js/object/get-prototype-of":6,"babel-runtime/helpers/classCallCheck":10,"babel-runtime/helpers/createClass":11,"babel-runtime/helpers/inherits":13,"babel-runtime/helpers/possibleConstructorReturn":14}],84:[function(require,module,exports){"use strict";var _cpu=require("./cpu");var _cpu2=_interopRequireDefault(_cpu);var _tinyvm=require("./tinyvm");var _tinyvm2=_interopRequireDefault(_tinyvm);var _debugger=require("./debugger");var _debugger2=_interopRequireDefault(_debugger);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}if(typeof window!=="undefined"){window.TinyVM=_tinyvm2.default;window.CPU=_cpu2.default;window.Debugger=_debugger2.default}},{"./cpu":81,"./debugger":82,"./tinyvm":92}],85:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _typeof2=require("babel-runtime/helpers/typeof");var _typeof3=_interopRequireDefault(_typeof2);var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _get2=require("babel-runtime/helpers/get");var _get3=_interopRequireDefault(_get2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _device=require("./device");var _device2=_interopRequireDefault(_device);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Keyboard=function(_Device){(0,_inherits3.default)(Keyboard,_Device);function Keyboard(){(0,_classCallCheck3.default)(this,Keyboard);var _this=(0,_possibleConstructorReturn3.default)(this,(0,_getPrototypeOf2.default)(Keyboard).call(this));_this.KBD_MODE_POLL=0;_this.KBD_MODE_INTERRUPT=1;_this.KBD_OP_POP=1;_this._const=_this.constantList();_this._queue=[];_this._mode=_this.KBD_MODE_POLL;return _this}(0,_createClass3.default)(Keyboard,[{key:"name",value:function name(){return"TinyKeyboard"}},{key:"deviceType",value:function deviceType(){return _device2.default.Type.KEYBOARD}},{key:"version",value:function version(){return 0}},{key:"hasInterrupt",value:function hasInterrupt(){return true}},{key:"constantList",value:function constantList(){return{KBD_TYPE:0,KBD_VERSION:1,KBD_INTERRUPT:2,KDB_NAME:3,KBD_MODE:16,KBD_QUEUE_FULL:17,KBD_DEQUEUE:18,KBD_FRONT:20}}},{key:"addEvent",value:function addEvent(event){if((typeof event==="undefined"?"undefined":(0,_typeof3.default)(event))!=="object"){throw new Error("Hash expected")}else if(event.event===undefined||event.shift===undefined||event.control===undefined||event.alt===undefined||event.key===undefined){throw new Error("Expected format: { event, shift, control, alt, key }")}else if(event.event!=="press"&&event.event!=="release"){throw new Error("Event must be one of press/release")}if(this._queue.length<Keyboard.QUEUE_SIZE){this._queue.push((event.event==="release"?1:0)<<31|(event.shift?1:0)<<30|(event.control?1:0)<<29|(event.alt?1:0)<<28|event.key&16777215);if(this._mode==this.KBD_MODE_INTERRUPT){this.fireInterrupt()}}}},{key:"get",value:function get(a){if(a<16){return(0,_get3.default)((0,_getPrototypeOf2.default)(Keyboard.prototype),"get",this).call(this,a)}else if(a===this._const.KBD_MODE){return this._mode}else if(a===this._const.KBD_QUEUE_FULL){return this._queue.length===Keyboard.QUEUE_SIZE?1:0}else if(a===this._const.KBD_DEQUEUE){this._queue.shift()}else if(a>=this._const.KBD_FRONT||a<this._const.KBD_FRONT+4){var v=this._queue.length===0?0:this._queue[0];switch(a%4){case 0:return v&255;case 1:return v>>8&255;case 2:return v>>16&255;case 3:return v>>24&255}}return 0}},{key:"set",value:function set(a,v){if(a<16){(0,_get3.default)((0,_getPrototypeOf2.default)(Keyboard.prototype),"set",this).call(this,a,v)}else if(a===this._const.KBD_MODE){this._mode=v}}},{key:"queue",get:function get(){return this._queue.slice()}}]);return Keyboard}(_device2.default);exports.default=Keyboard;Keyboard.QUEUE_SIZE=16},{"./device":83,"babel-runtime/core-js/object/get-prototype-of":6,"babel-runtime/helpers/classCallCheck":10,"babel-runtime/helpers/createClass":11,"babel-runtime/helpers/get":12,"babel-runtime/helpers/inherits":13,"babel-runtime/helpers/possibleConstructorReturn":14,"babel-runtime/helpers/typeof":16}],86:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var LSBStorage=function(){function LSBStorage(){(0,_classCallCheck3.default)(this,LSBStorage);if(this.constructor===LSBStorage){throw new TypeError("Abstact class cannot be instantiated.")}}(0,_createClass3.default)(LSBStorage,[{key:"get16",value:function get16(a){return this.get(a+1)<<8|this.get(a)}},{key:"set16",value:function set16(a,v){this.set(a,v&255);this.set(a+1,v>>8&255)}},{key:"get32",value:function get32(a){var v=this.get(a+3)<<24|this.get(a+2)<<16|this.get(a+1)<<8|this.get(a);return v>>>0}},{key:"set32",value:function set32(a,v){this.set(a,v&255);this.set(a+1,v>>>8&255);this.set(a+2,v>>>16&255);this.set(a+3,v>>>24)}},{key:"getString",value:function getString(a,sz){var str=[];for(var i=0;i<sz;++i){str.push(String.fromCharCode(this.get(a+i)))}return str.join("")}},{key:"setString",value:function setString(a,v){for(var i=0;i<v.length;++i){this.set(a+i,v.charCodeAt(i))}}},{key:"getArray",value:function getArray(pos,sz){var a=[];for(var i=pos;i<pos+sz;++i){a.push(this.get(i))}return a}},{key:"setArray",value:function setArray(pos,array){for(var i=0;i<array.length;++i){this.set(i+pos,array[i])}}}]);return LSBStorage}();exports.default=LSBStorage},{"babel-runtime/helpers/classCallCheck":10,"babel-runtime/helpers/createClass":11}],87:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _get2=require("babel-runtime/helpers/get");var _get3=_interopRequireDefault(_get2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _device=require("../src/device");var _device2=_interopRequireDefault(_device);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var MMU=function(_Device){(0,_inherits3.default)(MMU,_Device);function MMU(ram){(0,_classCallCheck3.default)(this,MMU);var _this=(0,_possibleConstructorReturn3.default)(this,(0,_getPrototypeOf2.default)(MMU).call(this));_this._ram=ram;_this.reset();_this.MMU_ERR_NONE=0;_this.MMU_ERR_OUT_OF_BOUNDS=1;_this.MMU_PAGE_FAULT=2;return _this}(0,_createClass3.default)(MMU,[{key:"reset",value:function reset(){this._active=false;this._lastError=0;this._vmem={active:false,page:0}}},{key:"name",value:function name(){return"TinyMMU"}},{key:"deviceType",value:function deviceType(){return _device2.default.Type.MMU}},{key:"version",value:function version(){return 0}},{key:"hasInterrupt",value:function hasInterrupt(){return true}},{key:"constantList",value:function constantList(){return{MMU_TYPE:0,MMU_VERSION:1,MMU_INTERRUPT:2,MMU_NAME:3,MMU_RAM_SZ:16,MMU_VMEM:20,MMU_ERR:24}}},{key:"translate",value:function translate(a){if(this._vmem.active){var pageOffset=a&4095;var pageTableOffset=a>>12&1023;var pageDirectoryOffset=a>>22&1023;var pageDirectoryAddress=this._vmem.page*4096+pageDirectoryOffset*4;var pageTableData=this._ram.get32(pageDirectoryAddress);var pageTable={page:pageTableData&65535,active:pageTableData>>31?true:false};if(!pageTable.active){var e=new Error;e.name="page fault";throw e}var pageTableAddress=pageTable.page*4096+pageTableOffset*4;var pageData=this._ram.get32(pageTableAddress);var page={page:pageData&65535,active:pageData>>31?true:false};if(!page.active){var e=new Error;e.name="page fault";throw e}var location=page.page*4096+pageOffset;return location}else{return a}}},{key:"get",value:function get(a){switch(a){case 16:return this._ram.size&255;case 17:return this._ram.size>>8&255;case 18:return this._ram.size>>16&255;case 19:return this._ram.size>>24&255;case 20:return this._vmem.page&255;case 21:return this._vmem.page>>8&255;case 22:return 0;case 23:return this._vmem.active?128:0;case 24:return this._lastError&255;case 25:return this._lastError>>8&255;case 26:return this._lastError>>16&255;case 27:return this._lastError>>24&255;default:return(0,_get3.default)((0,_getPrototypeOf2.default)(MMU.prototype),"get",this).call(this,a)}}},{key:"set",value:function set(a,v){switch(a){case 20:this._vmem.page&=~255;this._vmem.page|=v&255;break;case 21:this._vmem.page&=~65280;this._vmem.page|=v<<8&127;break;case 23:this._vmem.active=v>>7?true:false;break;case 24:this._lastError&=~255;this._lastError|=v&255;break;case 25:this._lastError&=~65280;this._lastError|=v<<8;break;case 26:this._lastError&=~16711680;this._lastError|=v<<16;break;case 27:this._lastError&=~4278190080;this._lastError|=v<<24;break;default:(0,_get3.default)((0,_getPrototypeOf2.default)(MMU.prototype),"set",this).call(this,a,v)}}},{key:"getMemory",value:function getMemory(a){try{return this._ram.get(this.translate(a))}catch(e){if(e.name==="out of bounds"){this.fireInterrupt(this.MMU_ERR_OUT_OF_BOUNDS)}else{throw e}}}},{key:"setMemory",value:function setMemory(a,v){try{this._ram.set(this.translate(a),v)}catch(e){if(e.name==="out of bounds"){this.fireInterrupt(this.MMU_ERR_OUT_OF_BOUNDS)}else{throw e}}}},{key:"fireInterrupt",value:function fireInterrupt(err){this._lastError|=err;(0,_get3.default)((0,_getPrototypeOf2.default)(MMU.prototype),"fireInterrupt",this).call(this)}},{key:"active",get:function get(){return this._vmem.active}}]);return MMU}(_device2.default);exports.default=MMU},{"../src/device":83,"babel-runtime/core-js/object/get-prototype-of":6,"babel-runtime/helpers/classCallCheck":10,"babel-runtime/helpers/createClass":11,"babel-runtime/helpers/get":12,"babel-runtime/helpers/inherits":13,"babel-runtime/helpers/possibleConstructorReturn":14}],88:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getIterator2=require("babel-runtime/core-js/get-iterator");var _getIterator3=_interopRequireDefault(_getIterator2);var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _lsbstorage=require("./lsbstorage");var _lsbstorage2=_interopRequireDefault(_lsbstorage);var _device=require("./device");var _device2=_interopRequireDefault(_device);var _ram=require("./ram");var _ram2=_interopRequireDefault(_ram);var _mmu=require("./mmu");var _mmu2=_interopRequireDefault(_mmu);var _cpu=require("./cpu");var _cpu2=_interopRequireDefault(_cpu);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Motherboard=function(_LSBStorage){(0,_inherits3.default)(Motherboard,_LSBStorage);function Motherboard(){(0,_classCallCheck3.default)(this,Motherboard);var _this=(0,_possibleConstructorReturn3.default)(this,(0,_getPrototypeOf2.default)(Motherboard).call(this));_this._devices=[];_this._addr=4026535936;_this._interruptCount=1;_this._mmu=null;_this._cpu=null;_this._memory=new _ram2.default(4);_this._initialAddress=0;_this.MB_DEV_ADDR=4026531840;_this.MB_ERR=4026532864;_this.MB_CPU_INIT=4294967293;_this.MB_ERR_NONE=0;_this.MB_ERR_UNAUTH_READ=1;_this.MB_ERR_UNAUTH_WRITE=2;return _this}(0,_createClass3.default)(Motherboard,[{key:"reset",value:function reset(){this._memory.reset();var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=(0,_getIterator3.default)(this.devices),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var d=_step.value;d.reset()}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}}},{key:"addDevice",value:function addDevice(dev){this._devices.push(dev);dev.initializeConstants(this._addr);dev.addr=this._addr;dev.mb=this;this._memory.set32((this._devices.length-1)*4,this._addr);this._addr+=dev.memorySize();if(dev.hasInterrupt()){dev.interruptNumber=++this._interruptCount}if(dev.deviceType()===_device2.default.Type.MMU){this._mmu=dev}else if(dev.deviceType()===_device2.default.Type.CPU){this._cpu=dev}else if(dev.deviceType()===_device2.default.Type.BIOS){this._cpu.PC=dev.BIOS_CODE}}},{key:"step",value:function step(){var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=(0,_getIterator3.default)(this._devices),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var d=_step2.value;d.step()}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally{try{if(!_iteratorNormalCompletion2&&_iterator2.return){_iterator2.return()}}finally{if(_didIteratorError2){throw _iteratorError2}}}if(this._cpu){this._cpu.checkInterrupts()}}},{key:"get",value:function get(a){if(a<4026531840&&this._mmu){return this._mmu.getMemory(a)}else if(a>=4026531840&&a<4026535936){return this._memory.get(a-4026531840)}else if(a>=4294967292){return this._initialAddress&255}else if(a>=4294967293){return this._initialAddress>>8&255}else if(a>=4294967294){return this._initialAddress>>16&255}else if(a>=4294967295){return this._initialAddress>>24&255}else{var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=(0,_getIterator3.default)(this._devices),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var d=_step3.value;if(a>=d.addr&&a<d.addr+d.memorySize()){return d.get(a-d.addr)}}}catch(err){_didIteratorError3=true;_iteratorError3=err}finally{try{if(!_iteratorNormalCompletion3&&_iterator3.return){_iterator3.return()}}finally{if(_didIteratorError3){throw _iteratorError3}}}this._memory.set(1024,this.MB_ERR_UNAUTH_READ);this.pushInterrupt(1);return 0}}},{key:"set",value:function set(a,v){if(a<4026531840&&this._mmu){this._mmu.setMemory(a,v)}else if(a==4026532864){this._memory[1024]=v}else if(a>=4026531840&&a<4026535936){this._memory.set(1024,this.MB_ERR_UNAUTH_WRITE);this.pushInterrupt(1)}else{var _iteratorNormalCompletion4=true;var _didIteratorError4=false;var _iteratorError4=undefined;try{for(var _iterator4=(0,_getIterator3.default)(this._devices),_step4;!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=true){var d=_step4.value;if(a>=d.addr&&a<d.addr+d.memorySize()){d.set(a-d.addr,v);return}}}catch(err){_didIteratorError4=true;_iteratorError4=err}finally{try{if(!_iteratorNormalCompletion4&&_iterator4.return){_iterator4.return()}}finally{if(_didIteratorError4){throw _iteratorError4}}}this._memory.set(1024,this.MB_ERR_UNAUTH_WRITE);this.pushInterrupt(1)}}},{key:"pushInterrupt",value:function pushInterrupt(n){if(this._cpu){this._cpu.pushInterrupt(n)}}},{key:"memoryMap",value:function memoryMap(){var map=[];if(this._mmu){map.push({addr:0,deviceType:_device2.default.Type.RAM,size:this._mmu.active()?4026531840:this._mmu.ramSize()})}if(this._mmu.ramSize()<4026531840&&!this._mmu.active()){map.push({addr:this._mmu.ramSize(),deviceType:_device2.default.Type.UNUSED,size:4026531840-this._mmu.ramSize()})}map.push({addr:4026531840,deviceType:_device2.default.Type.MOTHERBOARD,size:4096});var addr=4026535936;var _iteratorNormalCompletion5=true;var _didIteratorError5=false;var _iteratorError5=undefined;try{for(var _iterator5=(0,_getIterator3.default)(this._devices),_step5;!(_iteratorNormalCompletion5=(_step5=_iterator5.next()).done);_iteratorNormalCompletion5=true){var d=_step5.value;map.push({addr:addr,
deviceType:d.deviceType(),size:d.memorySize()});addr+=d.memorySize()}}catch(err){_didIteratorError5=true;_iteratorError5=err}finally{try{if(!_iteratorNormalCompletion5&&_iterator5.return){_iterator5.return()}}finally{if(_didIteratorError5){throw _iteratorError5}}}map.push({addr:addr,deviceType:_device2.default.Type.UNUSED,size:4294967296-addr});return map}},{key:"devices",get:function get(){return this._devices.slice(0)}}]);return Motherboard}(_lsbstorage2.default);exports.default=Motherboard},{"./cpu":81,"./device":83,"./lsbstorage":86,"./mmu":87,"./ram":89,"babel-runtime/core-js/get-iterator":2,"babel-runtime/core-js/object/get-prototype-of":6,"babel-runtime/helpers/classCallCheck":10,"babel-runtime/helpers/createClass":11,"babel-runtime/helpers/inherits":13,"babel-runtime/helpers/possibleConstructorReturn":14}],89:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _lsbstorage=require("./lsbstorage");var _lsbstorage2=_interopRequireDefault(_lsbstorage);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var RAM=function(_LSBStorage){(0,_inherits3.default)(RAM,_LSBStorage);function RAM(_sizeKb){(0,_classCallCheck3.default)(this,RAM);var _this=(0,_possibleConstructorReturn3.default)(this,(0,_getPrototypeOf2.default)(RAM).call(this));_this._size=_sizeKb*1024;_this.reset();return _this}(0,_createClass3.default)(RAM,[{key:"reset",value:function reset(){this._data=new Uint8Array(this._size)}},{key:"get",value:function get(a){if(a<0||a>=this._size){var e=new Error;e.name="out of bounds";throw e}else{return this._data[a]}}},{key:"set",value:function set(a,v){if(a<0||a>=this._size){var e=new Error;e.name="out of bounds";throw e}else if(v<0||v>255){var e=new Error;e.name="invalid data ("+v+")";throw e}else{this._data[a]=v}}},{key:"size",get:function get(){return this._size}}]);return RAM}(_lsbstorage2.default);exports.default=RAM},{"./lsbstorage":86,"babel-runtime/core-js/object/get-prototype-of":6,"babel-runtime/helpers/classCallCheck":10,"babel-runtime/helpers/createClass":11,"babel-runtime/helpers/inherits":13,"babel-runtime/helpers/possibleConstructorReturn":14}],90:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getIterator2=require("babel-runtime/core-js/get-iterator");var _getIterator3=_interopRequireDefault(_getIterator2);var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _get2=require("babel-runtime/helpers/get");var _get3=_interopRequireDefault(_get2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _device=require("./device");var _device2=_interopRequireDefault(_device);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Storage=function(_Device){(0,_inherits3.default)(Storage,_Device);function Storage(units){(0,_classCallCheck3.default)(this,Storage);var _this=(0,_possibleConstructorReturn3.default)(this,(0,_getPrototypeOf2.default)(Storage).call(this));if(units===undefined||units.constructor!==Array){throw new Error("`units` must be an array.")}if(units.length>4){throw new Error("Maximum of 4 units")}var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=(0,_getIterator3.default)(units),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var u=_step.value;if(!u.get||!u.set||!u.size){throw new Error("Missing method in unit")}}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}_this.STG_OP_READ=1;_this.STG_OP_WRITE=2;_this.STG_OP_SIZE=3;_this.STG_MODE_POLL=0;_this.STG_MODE_INTERRUPT=1;_this.STG_STATUS_OK=0;_this.STG_STATUS_WAITING=1;_this.STG_STATUS_ADDRESS_ERROR=2;_this.STG_STATUS_UNAVALIABLE=3;_this.STG_STATUS_PHYSICAL_ERROR=4;_this._units=units;_this._const=_this.constantList();_this._mode=_this.STG_MODE_POLL;_this._status=_this.STG_STATUS_OK;_this._p=new Uint32Array(8);_this._r=new Uint32Array(2);return _this}(0,_createClass3.default)(Storage,[{key:"name",value:function name(){return"TinyStorage"}},{key:"deviceType",value:function deviceType(){return _device2.default.Type.STORAGE}},{key:"version",value:function version(){return 0}},{key:"hasInterrupt",value:function hasInterrupt(){return true}},{key:"constantList",value:function constantList(){return{STG_TYPE:0,STG_VERSION:1,STG_INTERRUPT:2,STG_NAME:3,STG_MODE:16,STG_OP_STATUS:17,STG_UNIT_LIST:18,STG_OP:19,STG_P0:20,STG_P1:24,STG_P2:28,STG_P3:32,STG_P4:36,STG_P5:40,STG_P6:44,STG_P7:48,STG_R0:52,STG_R1:56}}},{key:"get",value:function get(a){if(a<16){return(0,_get3.default)((0,_getPrototypeOf2.default)(Storage.prototype),"get",this).call(this,a)}else if(a==this._const.STG_MODE){return this._mode}else if(a==this._const.STG_OP_STATUS){return this._status}else if(a==this._const.STG_UNIT_LIST){var n=0;for(var i in this._units){n<<=1;n|=1}return n}else{var v=undefined;if(a>=this._const.STG_P0&&a<this._const.STG_P0+32){v=this._p[Math.floor((a-this._const.STG_P0)/4)]}else if(a>=this._const.STG_R0&&a<this._const.STG_R0+8){v=this._r[Math.floor((a-this._const.STG_R0)/4)]}if(v!==undefined){switch(a%4){case 0:return v&255;case 1:return v>>8&255;case 2:return v>>16&255;case 3:return v>>24&255}}}return 0}},{key:"set",value:function set(a,v){if(a<16){(0,_get3.default)((0,_getPrototypeOf2.default)(Storage.prototype),"set",this).call(this,a,v)}else if(a==this._const.STG_MODE){this._mode=a==0?this.STG_MODE_POLL:this.STG_MODE_INTERRUPT}else if(a==this._const.STG_OP){this._r=this._execute(v)}else{var r=undefined,arr=undefined;if(a>=this._const.STG_P0&&a<this._const.STG_P0+32){r=Math.floor((a-this._const.STG_P0)/4);arr=this._p}if(arr){switch(a%4){case 0:arr[r]&=~255;arr[r]|=v;break;case 1:arr[r]&=~65280;arr[r]|=v<<8;break;case 2:arr[r]&=~16711680;arr[r]|=v<<16;break;case 3:arr[r]&=~4278190080;arr[r]|=v<<24;break}}}}},{key:"fireInterrupt",value:function fireInterrupt(status){this._status=status;if(this._mode==this.STG_MODE_INTERRUPT){(0,_get3.default)((0,_getPrototypeOf2.default)(Storage.prototype),"fireInterrupt",this).call(this)}}},{key:"_execute",value:function _execute(op){if(op===this.STG_OP_READ||op===this.STG_OP_WRITE||op===this.STG_OP_SIZE){if(this._p[0]>=this._units.length){this.fireInterrupt(this.STG_STATUS_UNAVALIABLE);return[0,0]}}if(op===this.STG_OP_SIZE){var r=this._units[this._p[0]].size;var upperBytes=Math.floor(r/Math.pow(2,32));var lowerBytes=r&4294967295;return[lowerBytes,upperBytes]}else if(op===this.STG_OP_READ){var unit=this._units[this._p[0]];var stgLocation=(this._p[1]|Math.floor(this._p[2]*Math.pow(2,32)))>>>0;var memLocation=this._p[3];var size=this._p[4];if(stgLocation+size>unit.size){this.fireInterrupt(this.STG_STATUS_ADDRESS_ERROR);return[0,0]}for(var i=0;i<size;++i){this.mb.set(memLocation+i,unit.get(stgLocation+i))}this.fireInterrupt(this.STG_STATUS_OK)}else if(op===this.STG_OP_WRITE){var unit=this._units[this._p[0]];var memLocation=this._p[1];var stgLocation=(this._p[2]|Math.floor(this._p[3]*Math.pow(2,32)))>>>0;var size=this._p[4];if(stgLocation+size>unit.size){this.fireInterrupt(this.STG_STATUS_ADDRESS_ERROR);return[0,0]}for(var i=0;i<size;++i){unit.set(stgLocation+i,this.mb.get(memLocation+i))}this.fireInterrupt(this.STG_STATUS_OK)}return[0,0]}}]);return Storage}(_device2.default);exports.default=Storage},{"./device":83,"babel-runtime/core-js/get-iterator":2,"babel-runtime/core-js/object/get-prototype-of":6,"babel-runtime/helpers/classCallCheck":10,"babel-runtime/helpers/createClass":11,"babel-runtime/helpers/get":12,"babel-runtime/helpers/inherits":13,"babel-runtime/helpers/possibleConstructorReturn":14}],91:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _get2=require("babel-runtime/helpers/get");var _get3=_interopRequireDefault(_get2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _device=require("./device");var _device2=_interopRequireDefault(_device);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Timer=function(_Device){(0,_inherits3.default)(Timer,_Device);function Timer(){(0,_classCallCheck3.default)(this,Timer);var _this=(0,_possibleConstructorReturn3.default)(this,(0,_getPrototypeOf2.default)(Timer).call(this));_this._const=_this.constantList();_this._dateDiff=new Date(2016,1,1).valueOf();_this._currentTime=Date.now()-_this._dateDiff;_this._timers=new Uint32Array(10);_this._counters=new Uint32Array(10);_this._lastStep=Date.now();_this._interruptCalled=0;return _this}(0,_createClass3.default)(Timer,[{key:"name",value:function name(){return"TinyTimer"}},{key:"deviceType",value:function deviceType(){return _device2.default.Type.TIMER}},{key:"version",value:function version(){return 0}},{key:"hasInterrupt",value:function hasInterrupt(){return true}},{key:"constantList",value:function constantList(){return{TM_TYPE:0,TM_VERSION:1,TM_INTERRUPT:2,TM_NAME:3,TM_CLOCK:16,TM_TIMER0:20,TM_TIMER1:24,TM_TIMER2:28,TM_TIMER3:32,TM_TIMER4:36,TM_TIMER5:40,TM_TIMER6:44,TM_TIMER7:48,TM_TIMER8:52,TM_TIMER9:56,TM_COUNTER0:60,TM_COUNTER1:64,TM_COUNTER2:68,TM_COUNTER3:72,TM_COUNTER4:76,TM_COUNTER5:80,TM_COUNTER6:84,TM_COUNTER7:88,TM_COUNTER8:92,TM_COUNTER9:96,TM_CUR_INT:100}}},{key:"get",value:function get(a){if(a<16){return(0,_get3.default)((0,_getPrototypeOf2.default)(Timer.prototype),"get",this).call(this,a)}else if(a===this._const.TM_CUR_INT){return this._interruptCalled}else{var v=undefined;if(a>=this._const.TM_CLOCK&&a<this._const.TM_CLOCK+4){v=this._currentTime}else if(a>=this._const.TM_TIMER0&&a<this._const.TM_TIMER9+4){v=this._timers[Math.floor((a-this._const.TM_TIMER0)/4)]}else if(a>=this._const.TM_COUNTER0&&a<this._const.TM_COUNTER9+4){v=this._timers[Math.floor((a-this._const.TM_COUNTER0)/4)]}if(v!==undefined){switch(a%4){case 0:return v&255;case 1:return v>>8&255;case 2:return v>>16&255;case 3:return v>>24&255}}}return 0}},{key:"set",value:function set(a,v){if(a<16){(0,_get3.default)((0,_getPrototypeOf2.default)(Timer.prototype),"set",this).call(this,a,v)}else{var r=undefined;if(a>=this._const.TM_TIMER0&&a<this._const.TM_TIMER9+32){r=Math.floor((a-this._const.TM_TIMER0)/4)}if(r!==undefined){switch(a%4){case 0:this._timers[r]&=~255;this._timers[r]|=v;this._counters[r]=0;break;case 1:this._timers[r]&=~65280;this._timers[r]|=v<<8;this._counters[r]=0;break;case 2:this._timers[r]&=~16711680;this._timers[r]|=v<<16;this._counters[r]=0;break;case 3:this._timers[r]&=~4278190080;this._timers[r]|=v<<24;this._counters[r]=0;break}}}}},{key:"step",value:function step(){this._currentTime=Date.now()-this._dateDiff;var now=Date.now();for(var i=0;i<10;++i){if(this._timers[i]!==0){this._counters[i]+=now-this._lastStep;if(this._counters[i]>=this._timers[i]){this._counters[i]=0;this._interruptCalled=i;this.fireInterrupt()}}}this._lastStep=now}}]);return Timer}(_device2.default);exports.default=Timer},{"./device":83,"babel-runtime/core-js/object/get-prototype-of":6,"babel-runtime/helpers/classCallCheck":10,"babel-runtime/helpers/createClass":11,"babel-runtime/helpers/get":12,"babel-runtime/helpers/inherits":13,"babel-runtime/helpers/possibleConstructorReturn":14}],92:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _motherboard=require("./motherboard");var _motherboard2=_interopRequireDefault(_motherboard);var _ram=require("./ram");var _ram2=_interopRequireDefault(_ram);var _mmu=require("./mmu");var _mmu2=_interopRequireDefault(_mmu);var _cpu=require("./cpu");var _cpu2=_interopRequireDefault(_cpu);var _storage=require("./storage");var _storage2=_interopRequireDefault(_storage);var _keyboard=require("./keyboard");var _keyboard2=_interopRequireDefault(_keyboard);var _timer=require("./timer");var _timer2=_interopRequireDefault(_timer);var _bios=require("./bios");var _bios2=_interopRequireDefault(_bios);var _video=require("./video");var _video2=_interopRequireDefault(_video);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var TinyVM=function(){function TinyVM(ramSizeKb,storageUnits,canvas,biosCode){(0,_classCallCheck3.default)(this,TinyVM);this.mb=new _motherboard2.default;this.mmu=new _mmu2.default(new _ram2.default(ramSizeKb));this.cpu=new _cpu2.default(this.mb);this.storage=new _storage2.default(storageUnits);this.keyboard=new _keyboard2.default;this.timer=new _timer2.default;this.bios=new _bios2.default(biosCode);this.video=new _video2.default(canvas);this.mb.addDevice(this.mmu);this.mb.addDevice(this.cpu);this.mb.addDevice(this.storage);this.mb.addDevice(this.keyboard);this.mb.addDevice(this.timer);this.mb.addDevice(this.bios);this.mb.addDevice(this.video)}(0,_createClass3.default)(TinyVM,[{key:"step",value:function step(){this.mb.step()}}]);return TinyVM}();exports.default=TinyVM},{"./bios":79,"./cpu":81,"./keyboard":85,"./mmu":87,"./motherboard":88,"./ram":89,"./storage":90,"./timer":91,"./video":93,"babel-runtime/helpers/classCallCheck":10,"babel-runtime/helpers/createClass":11}],93:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _get2=require("babel-runtime/helpers/get");var _get3=_interopRequireDefault(_get2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _device=require("./device");var _device2=_interopRequireDefault(_device);var _chars=require("./chars");var _chars2=_interopRequireDefault(_chars);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Video=function(_Device){(0,_inherits3.default)(Video,_Device);function Video(canvas){(0,_classCallCheck3.default)(this,Video);var _this=(0,_possibleConstructorReturn3.default)(this,(0,_getPrototypeOf2.default)(Video).call(this));_this.VID_OP_CLRSCR=2;_this.VID_OP_DRAW_PX=3;_this.VID_OP_GET_PX=4;_this.VID_OP_WRITE=5;_this._const=_this.constantList();_this._width=canvas.width;_this._height=canvas.height;_this._canvas=canvas;_this._ctx=canvas.getContext("2d");_this._data=_this._ctx.getImageData(0,0,_this._width,_this._height);_this._p=new Uint32Array(8);_this._r=new Uint32Array(2);_this._charCache={};_this._ctx.fillStyle="black";_this._ctx.fillRect(0,0,_this._width,_this._height);return _this}(0,_createClass3.default)(Video,[{key:"name",value:function name(){return"TinyVideo"}},{key:"deviceType",value:function deviceType(){return _device2.default.Type.VIDEO}},{key:"version",value:function version(){return 0}},{key:"hasInterrupt",value:function hasInterrupt(){return false}},{key:"memorySize",value:function memorySize(){return 100663296}},{key:"constantList",value:function constantList(){return{VID_TYPE:0,VID_VERSION:1,VID_INTERRUPT:2,VID_NAME:3,VID_WIDTH:16,VID_HEIGHT:17,VID_OP:18,VID_P0:20,VID_P1:24,VID_P2:28,VID_P3:32,VID_P4:36,VID_P5:40,VID_P6:44,VID_P7:48,VID_R0:52,VID_R1:56,VID_DATA:65536}}},{key:"get",value:function get(a){if(a<16){return(0,_get3.default)((0,_getPrototypeOf2.default)(Video.prototype),"get",this).call(this,a)}else if(a===this._const.VID_WIDTH){return this._width}else if(a===this._const.VID_HEIGHT){return this._height}else{var v=undefined;if(a>=this._const.VID_P0&&a<this._const.VID_P7+4){v=this._p[Math.floor((a-this._const.VID_P0)/4)]}else if(a>=this._const.VID_R0&&a<this._const.VID_R1+4){v=this._r[Math.floor((a-this._const.VID_R0)/4)]}if(v!==undefined){switch(a%4){case 0:return v&255;case 1:return v>>8&255;case 2:return v>>16&255;case 3:return v>>24&255}}}return 0}},{key:"set",value:function set(a,v){if(a<16){(0,_get3.default)((0,_getPrototypeOf2.default)(Video.prototype),"set",this).call(this,a,v)}else if(a===this._const.VID_OP){this._r=this._execute(v)}else{var r=undefined,arr=undefined;if(a>=this._const.VID_P0&&a<this._const.VID_P7+4){r=Math.floor((a-this._const.VID_P0)/4);arr=this._p}else if(a>=this._const.VID_R0&&a<this._const.VID_R1+4){r=Math.floor((a-this._const.VID_R0)/4);arr=this._p}if(arr){switch(a%4){case 0:arr[r]&=~255;arr[r]|=v;break;case 1:arr[r]&=~65280;arr[r]|=v<<8;break;case 2:arr[r]&=~16711680;arr[r]|=v<<16;break;case 3:arr[r]&=~4278190080;arr[r]|=v<<24;break}}}}},{key:"_execute",value:function _execute(op){switch(op){case this.VID_OP_CLRSCR:this._ctx.fillStyle="rgb("+(this._p[0]>>16&255)+","+(this._p[0]>>8&255)+","+(this._p[0]&255)+")";this._ctx.fillRect(0,0,this._width,this._height);break;case this.VID_OP_DRAW_PX:var px=(this._p[0]+this._p[1]*this._width)*4;this._data.data[px+3]=255;this._data.data[px+0]=this._p[2]>>16&255;this._data.data[px+1]=this._p[2]>>8&255;this._data.data[px+2]=this._p[2]&255;this._ctx.putImageData(this._data,0,0,this._p[0],this._p[1],1,1);break;case this.VID_OP_GET_PX:var d=this._ctx.getImageData(this._p[0],this._p[1],1,1).data;return[d[0]<<16|d[1]<<8|d[2],0];case this.VID_OP_WRITE:this._drawChar.apply(this,this._p.slice(0,7));break}return[0,0]}},{key:"_drawChar",value:function _drawChar(c,x,y,bg,fg,offx,offy){var image=this._charImage(c,bg,fg);var px=10+x*6+offx;var py=10+y*9+offy;this._ctx.putImageData(image,px,py)}},{key:"_charImage",value:function _charImage(c,bg,fg){var idx=c.toString(16)+"_"+bg.toString(16)+fg.toString(16);var value=this._charCache[idx];if(value){return value}else{var chr=this._createCharImage(c,bg,fg);this._charCache[idx]=chr;return chr}}},{key:"_createCharImage",value:function _createCharImage(c,bg,fg){var img=this._ctx.createImageData(6,9);for(var y=0;y<9;++y){for(var x=0;x<6;++x){var p=(5-x+y*6)*4;var v=_chars2.default[c][y]>>x&1;img.data[p+3]=255;img.data[p]=(v?fg:bg)>>16&255;img.data[p+1]=(v?fg:bg)>>8&255;img.data[p+2]=(v?fg:bg)&255}}return img}}]);return Video}(_device2.default);exports.default=Video},{"./chars":80,"./device":83,"babel-runtime/core-js/object/get-prototype-of":6,"babel-runtime/helpers/classCallCheck":10,"babel-runtime/helpers/createClass":11,"babel-runtime/helpers/get":12,"babel-runtime/helpers/inherits":13,"babel-runtime/helpers/possibleConstructorReturn":14}]},{},[84]);